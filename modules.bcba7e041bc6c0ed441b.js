/*! For license information please see modules.bcba7e041bc6c0ed441b.js.LICENSE.txt */
(self.webpackChunkcryptopro_cades_example=self.webpackChunkcryptopro_cades_example||[]).push([[54],{220:(e,t,r)=>{"use strict";r.d(t,{$:()=>We,BD:()=>et,EI:()=>Ye,FC:()=>fe,GM:()=>Me,Gh:()=>ct,HQ:()=>Ze,Hk:()=>Xe,IK:()=>ot,Lv:()=>lt,NI:()=>Qe,Ox:()=>ze,SZ:()=>qe,T9:()=>Ue,Tz:()=>Je,WV:()=>le,Yw:()=>tt,ZD:()=>ut,_K:()=>ke,eN:()=>ht,fi:()=>we,gF:()=>Ge,ge:()=>ye,kE:()=>Ke,l4:()=>Oe,p2:()=>de,qU:()=>je,rP:()=>Pe,sc:()=>ce,z8:()=>Ee});var n=r(656),i=r(422);function s(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function a(e){let t=0,r=0;for(let r=0;r<e.length;r++){t+=e[r].byteLength}const n=new Uint8Array(t);for(let t=0;t<e.length;t++){const i=e[t];n.set(new Uint8Array(i),r),r+=i.byteLength}return n.buffer}function o(e,t,r,n){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class l{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return a(this.items)}}const u=[new Uint8Array([1])],c="0123456789",h="name",f="valueHexView",m="",g=new ArrayBuffer(0),d=new Uint8Array(0),p="EndOfContent",y="OCTET STRING",b="BIT STRING";function w(e){var t;return(t=class extends e{constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!==(t=r.isHexOnly)&&void 0!==t&&t,this.valueHexView=r.valueHex?n.vJ.toUint8Array(r.valueHex):d}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}fromBER(e,t,r){const n=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!o(this,n,t,r))return-1;const i=t+r;return this.valueHexView=n.subarray(t,i),this.valueHexView.length?(this.blockLength=r,i):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",g)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:n.ep.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class v{constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:i=d}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=n.vJ.toUint8Array(i)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:n.ep.ToHex(this.valueBeforeDecodeView)}}}v.NAME="baseBlock";class k extends v{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}k.NAME="valueBlock";class A extends(w(v)){constructor({idBlock:e={}}={}){var t,r,i,s;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?n.vJ.toUint8Array(e.valueHex):d,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(i=e.tagNumber)&&void 0!==i?i:-1,this.isConstructed=null!==(s=e.isConstructed)&&void 0!==s&&s):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",g}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){const r=i.lL(this.tagNumber,7),n=new Uint8Array(r),s=r.byteLength,a=new Uint8Array(s+1);if(a[0]=31|t,!e){for(let e=0;e<s-1;e++)a[e+1]=128|n[e];a[s]=n[s-1]}return a.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){const e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){const s=n.vJ.toUint8Array(e);if(!o(this,s,t,r))return-1;const a=s.subarray(t,t+r);if(0===a.length)return this.error="Zero buffer length",-1;switch(192&a[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&a[0]),this.isHexOnly=!1;const l=31&a[0];if(31!==l)this.tagNumber=l,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&a[e];){if(t[e-1]=127&a[e],e++,e>=a.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){r+=255;const e=new Uint8Array(r);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&a[e];const n=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=t[r];t=this.valueHexView=new Uint8Array(e),t.set(n),this.blockLength<=9?this.tagNumber=i.r9(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}A.NAME="identificationBlock";class S extends v{constructor({lenBlock:e={}}={}){var t,r,n;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(n=e.length)&&void 0!==n?n:0}fromBER(e,t,r){const s=n.vJ.toUint8Array(e);if(!o(this,s,t,r))return-1;const a=s.subarray(t,t+r);if(0===a.length)return this.error="Zero buffer length",-1;if(255===a[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===a[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&a[0]),!1===this.longFormUsed)return this.length=a[0],this.blockLength=1,t+this.blockLength;const l=127&a[0];if(l>8)return this.error="Too big integer",-1;if(l+1>a.length)return this.error="End of input reached before message was fully decoded",-1;const u=t+1,c=s.subarray(u,u+l);return 0===c[l-1]&&this.warnings.push("Needlessly long encoded length"),this.length=i.r9(c,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=l+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const n=i.lL(this.length,8);if(n.byteLength>127)return this.error="Too big length",g;if(t=new ArrayBuffer(n.byteLength+1),e)return t;const s=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=s[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}S.NAME="lengthBlock";const B={};class C extends v{constructor({name:e="",optional:t=!1,primitiveSchema:r,...n}={},i){super(n),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new A(n),this.lenBlock=new S(n),this.valueBlock=i?new i(n):new k(n)}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e,t){const r=t||new l;t||E(this);const n=this.idBlock.toBER(e);if(r.write(n),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;const n=this.lenBlock.toBER(e);r.write(n),r.write(t)}return t?g:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():n.ep.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${n.ep.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;const t=this.toBER(),r=e.toBER();return i.dN(t,r)}}function E(e){if(e instanceof B.Constructed)for(const t of e.valueBlock.value)E(t)&&(e.lenBlock.isIndefiniteForm=!0);return!!e.lenBlock.isIndefiniteForm}C.NAME="BaseBlock";class N extends C{constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}N.NAME="BaseStringBlock";class x extends(w(k)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}var I,P,H,V,L,U,O,D,T,$,R,j,_,K,F,M,J,z,G,q,W,Z,Q,Y,X,ee,te,re,ne,ie,se,ae,oe;x.NAME="PrimitiveValueBlock";class le extends C{constructor(e={}){super(e,x),this.idBlock.isConstructed=!1}}function ue(e,t=0,r=e.length){const n=t;let i=new C({},k);const s=new v;if(!o(s,e,t,r))return i.error=s.error,{offset:-1,result:i};if(!e.subarray(t,t+r).length)return i.error="Zero buffer length",{offset:-1,result:i};let a=i.idBlock.fromBER(e,t,r);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===a)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=a,r-=i.idBlock.blockLength,a=i.lenBlock.fromBER(e,t,r),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===a)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=a,r-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let l=C;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};l=B.EndOfContent;break;case 1:l=B.Boolean;break;case 2:l=B.Integer;break;case 3:l=B.BitString;break;case 4:l=B.OctetString;break;case 5:l=B.Null;break;case 6:l=B.ObjectIdentifier;break;case 10:l=B.Enumerated;break;case 12:l=B.Utf8String;break;case 13:l=B.RelativeObjectIdentifier;break;case 14:l=B.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:l=B.Sequence;break;case 17:l=B.Set;break;case 18:l=B.NumericString;break;case 19:l=B.PrintableString;break;case 20:l=B.TeletexString;break;case 21:l=B.VideotexString;break;case 22:l=B.IA5String;break;case 23:l=B.UTCTime;break;case 24:l=B.GeneralizedTime;break;case 25:l=B.GraphicString;break;case 26:l=B.VisibleString;break;case 27:l=B.GeneralString;break;case 28:l=B.UniversalString;break;case 29:l=B.CharacterString;break;case 30:l=B.BmpString;break;case 31:l=B.DATE;break;case 32:l=B.TimeOfDay;break;case 33:l=B.DateTime;break;case 34:l=B.Duration;break;default:{const e=i.idBlock.isConstructed?new B.Constructed:new B.Primitive;e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}}else l=i.idBlock.isConstructed?B.Constructed:B.Primitive;return i=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(i,l),a=i.fromBER(e,t,i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecodeView=e.subarray(n,n+i.blockLength),{offset:a,result:i}}function ce(e){if(!e.byteLength){const e=new C({},k);return e.error="Input buffer has zero length",{offset:-1,result:e}}return ue(n.vJ.toUint8Array(e).slice(),0,e.byteLength)}I=le,B.Primitive=I,le.NAME="PRIMITIVE";class he extends k{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const i=n.vJ.toUint8Array(e);if(!o(this,i,t,r))return-1;if(this.valueBeforeDecodeView=i.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let s=t;for(;a=this.isIndefiniteForm,l=r,(a?1:l)>0;){const e=ue(i,s,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(s=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===p)break}var a,l;return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===p?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(e,t){const r=t||new l;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?g:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}he.NAME="ConstructedValueBlock";class fe extends C{constructor(e={}){super(e,he),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}P=fe,B.Constructed=P,fe.NAME="CONSTRUCTED";class me extends k{fromBER(e,t,r){return t}toBER(e){return g}}me.override="EndOfContentValueBlock";class ge extends C{constructor(e={}){super(e,me),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}H=ge,B.EndOfContent=H,ge.NAME=p;class de extends C{constructor(e={}){super(e,k),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}V=de,B.Null=V,de.NAME="NULL";class pe extends(w(k)){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=n.vJ.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,r){const s=n.vJ.toUint8Array(e);return o(this,s,t,r)?(this.valueHexView=s.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,i.Gc.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}pe.NAME="BooleanValueBlock";class ye extends C{constructor(e={}){super(e,pe),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}L=ye,B.Boolean=L,ye.NAME="BOOLEAN";class be extends(w(he)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=he.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.NAME;if(t===p){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==y)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e,t){return this.isConstructed?he.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}be.NAME="OctetStringValueBlock";class we extends C{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},be),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(n.byteLength){const e=ue(n,0,n.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch(e){}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?fe.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${n.ep.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof we&&e.push(t.valueBlock.valueHexView);return n.vJ.concat(e)}}U=we,B.OctetString=U,we.NAME=y;class ve extends(w(he)){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let i=-1;if(this.isConstructed){if(i=he.prototype.fromBER.call(this,e,t,r),-1===i)return i;for(const e of this.value){const t=e.constructor.NAME;if(t===p){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==b)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return i}const s=n.vJ.toUint8Array(e);if(!o(this,s,t,r))return-1;const a=s.subarray(t,t+r);if(this.unusedBits=a[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const e=a.subarray(1);try{if(e.byteLength){const t=ue(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch(e){}}return this.valueHexView=a.subarray(1),this.blockLength=a.length,t+r}toBER(e,t){if(this.isConstructed)return he.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return g;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}ve.NAME="BitStringValueBlock";class ke extends C{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},ve),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return fe.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const r of t)e.push(r.toString(2).padStart(8,"0"));const r=e.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}}function Ae(e,t){const r=new Uint8Array([0]),n=new Uint8Array(e),s=new Uint8Array(t);let a=n.slice(0);const o=a.length-1,l=s.slice(0),u=l.length-1;let c=0;let h=0;for(let e=u<o?o:u;e>=0;e--,h++){if(!0==h<l.length)c=a[o-h]+l[u-h]+r[0];else c=a[o-h]+r[0];if(r[0]=c/10,!0==h>=a.length)a=i.Ir(new Uint8Array([c%10]),a);else a[o-h]=c%10}return r[0]>0&&(a=i.Ir(r,a)),a}function Se(e){if(e>=u.length)for(let t=u.length;t<=e;t++){const e=new Uint8Array([0]);let r=u[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=i.Ir(e,r)),u.push(r)}return u[e]}function Be(e,t){let r=0;const n=new Uint8Array(e),i=new Uint8Array(t),s=n.slice(0),a=s.length-1,o=i.slice(0),l=o.length-1;let u,c=0;for(let e=l;e>=0;e--,c++)if(u=s[a-c]-o[l-c]-r,!0==u<0)r=1,s[a-c]=u+10;else r=0,s[a-c]=u;if(r>0)for(let e=a-l+1;e>=0;e--,c++){if(u=s[a-c]-r,!(u<0)){r=0,s[a-c]=u;break}r=1,s[a-c]=u+10}return s.slice()}O=ke,B.BitString=O,ke.NAME=b;class Ce extends(w(k)){constructor({value:e,...t}={}){super(t),this._valueDec=0,void 0!==e&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=i.Gc.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(i.qE(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const s=this.valueHexView;return 0===s[0]&&0!=(128&s[1])?this.valueHexView=s.subarray(1):0!==n&&s.length<n&&(n-s.length>1&&(n=s.length+1),this.valueHexView=s.subarray(n-s.length)),i}toDER(e=!1){const t=this.valueHexView;switch(!0){case 0!=(128&t[0]):{const e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&0==(128&t[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n||this.setValueHex(),n}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=8*this.valueHexView.length-1;let t,r=new Uint8Array(8*this.valueHexView.length/3),n=0;const i=this.valueHexView;let s="",a=!1;for(let a=i.byteLength-1;a>=0;a--){t=i[a];for(let i=0;i<8;i++){if(1==(1&t))if(n===e)r=Be(Se(n),r),s="-";else r=Ae(r,Se(n));n++,t>>=1}}for(let e=0;e<r.length;e++)r[e]&&(a=!0),a&&(s+=c.charAt(r[e]));return!1===a&&(s+=c.charAt(0)),s}}D=Ce,Ce.NAME="IntegerValueBlock",Object.defineProperty(D.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Ee extends C{constructor(e={}){super(e,Ce),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return s(),BigInt(this.valueBlock.toString())}static fromBigInt(e){s();const t=BigInt(e),r=new l,i=t.toString(16).replace(/^-/,""),a=new Uint8Array(n.ep.FromHex(i));if(t<0){const e=new Uint8Array(a.length+(128&a[0]?1:0));e[0]|=128;const i=BigInt(`0x${n.ep.ToHex(e)}`)+t,s=n.vJ.toUint8Array(n.ep.FromHex(i.toString(16)));s[0]|=128,r.write(s)}else 128&a[0]&&r.write(new Uint8Array([0])),r.write(a);return new Ee({valueHex:r.final()})}convertToDER(){const e=new Ee({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new Ee({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}T=Ee,B.Integer=T,Ee.NAME="INTEGER";class Ne extends Ee{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}$=Ne,B.Enumerated=$,Ne.NAME="ENUMERATED";class xe extends(w(k)){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const s=n.vJ.toUint8Array(e);if(!o(this,s,t,r))return-1;const a=s.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&a[e],this.blockLength++,0!=(128&a[e]));e++);const l=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)l[e]=this.valueHexView[e];return this.valueHexView=l,0!=(128&a[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=i.r9(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){s();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=i.lL(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",g;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r}toString(){let e="";if(this.isHexOnly)e=n.ep.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}xe.NAME="sidBlock";class Ie extends k{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new xe;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,g;t.push(n)}return a(t)}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return void(this.value=[])}const r=parseInt(n,10);if(isNaN(r))return;e.valueDec=r+t,i=!1}else{const e=new xe;if(n>Number.MAX_SAFE_INTEGER){s();const t=BigInt(n);e.valueBigInt=t}else if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Ie.NAME="ObjectIdentifierValueBlock";class Pe extends C{constructor(e={}){super(e,Ie),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}R=Pe,B.ObjectIdentifier=R,Pe.NAME="OBJECT IDENTIFIER";class He extends(w(v)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;const s=n.vJ.toUint8Array(e);if(!o(this,s,t,r))return-1;const a=s.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&a[e],this.blockLength++,0!=(128&a[e]));e++);const l=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)l[e]=this.valueHexView[e];return this.valueHexView=l,0!=(128&a[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=i.r9(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=i.lL(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",g;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r.buffer}toString(){let e="";return e=this.isHexOnly?n.ep.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}He.NAME="relativeSidBlock";class Ve extends k{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new He;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e,t){const r=[];for(let t=0;t<this.value.length;t++){const n=this.value[t].toBER(e);if(0===n.byteLength)return this.error=this.value[t].error,g;r.push(n)}return a(r)}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1;const i=new He;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Ve.NAME="RelativeObjectIdentifierValueBlock";class Le extends C{constructor(e={}){super(e,Ve),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}j=Le,B.RelativeObjectIdentifier=j,Le.NAME="RelativeObjectIdentifier";class Ue extends fe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}_=Ue,B.Sequence=_,Ue.NAME="SEQUENCE";class Oe extends fe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}K=Oe,B.Set=K,Oe.NAME="SET";class De extends(w(k)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=m}toJSON(){return{...super.toJSON(),value:this.value}}}De.NAME="StringValueBlock";class Te extends De{}Te.NAME="SimpleStringValueBlock";class $e extends N{constructor({...e}={}){super(e,Te)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,n.vJ.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}$e.NAME="SIMPLE STRING";class Re extends $e{fromBuffer(e){this.valueBlock.valueHexView=n.vJ.toUint8Array(e);try{this.valueBlock.value=n.ep.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=n.ep.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(n.ep.FromUtf8String(e)),this.valueBlock.value=e}}Re.NAME="Utf8StringValueBlock";class je extends Re{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}F=je,B.Utf8String=F,je.NAME="UTF8String";class _e extends $e{fromBuffer(e){this.valueBlock.value=n.ep.ToUtf16String(e),this.valueBlock.valueHexView=n.vJ.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(n.ep.FromUtf16String(e))}}_e.NAME="BmpStringValueBlock";class Ke extends _e{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}M=Ke,B.BmpString=M,Ke.NAME="BMPString";class Fe extends $e{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let n=0;n<t;n++){const t=i.lL(e.charCodeAt(n),8),s=new Uint8Array(t);if(s.length>4)continue;const a=4-s.length;for(let e=s.length-1;e>=0;e--)r[4*n+e+a]=s[e]}this.valueBlock.value=e}}Fe.NAME="UniversalStringValueBlock";class Me extends Fe{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}J=Me,B.UniversalString=J,Me.NAME="UniversalString";class Je extends $e{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}z=Je,B.NumericString=z,Je.NAME="NumericString";class ze extends $e{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}G=ze,B.PrintableString=G,ze.NAME="PrintableString";class Ge extends $e{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}q=Ge,B.TeletexString=q,Ge.NAME="TeletexString";class qe extends $e{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}W=qe,B.VideotexString=W,qe.NAME="VideotexString";class We extends $e{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Z=We,B.IA5String=Z,We.NAME="IA5String";class Ze extends $e{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Q=Ze,B.GraphicString=Q,Ze.NAME="GraphicString";class Qe extends $e{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Y=Qe,B.VisibleString=Y,Qe.NAME="VisibleString";class Ye extends $e{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}X=Ye,B.GeneralString=X,Ye.NAME="GeneralString";class Xe extends $e{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}ee=Xe,B.CharacterString=ee,Xe.NAME="CharacterString";class et extends Qe{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,n.vJ.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){const e=new Array(7);return e[0]=i.vX(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=i.vX(this.month,2),e[2]=i.vX(this.day,2),e[3]=i.vX(this.hour,2),e[4]=i.vX(this.minute,2),e[5]=i.vX(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}te=et,B.UTCTime=te,et.NAME="UTCTime";class tt extends et{constructor(e={}){var t;super(e),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",s=0,a=0,o=0;if("Z"===e[e.length-1])n=e.substring(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substring(t+1),n=n.substring(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let i=parseInt(r.substring(0,2),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");if(a=e*i,4===r.length){if(i=parseInt(r.substring(2,4),10),isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");o=e*i}}}let l=n.indexOf(".");if(-1===l&&(l=n.indexOf(",")),-1!==l){const e=new Number(`0${n.substring(l)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");s=e.valueOf(),i=n.substring(0,l)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==l)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==l){let e=60*s;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==l){let e=60*s;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==l){const e=1e3*s;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const u=t.exec(i);if(null===u)throw new Error("Wrong input string for conversion");for(let e=1;e<u.length;e++)switch(e){case 1:this.year=parseInt(u[e],10);break;case 2:this.month=parseInt(u[e],10);break;case 3:this.day=parseInt(u[e],10);break;case 4:this.hour=parseInt(u[e],10)+a;break;case 5:this.minute=parseInt(u[e],10)+o;break;case 6:this.second=parseInt(u[e],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){const e=[];return e.push(i.vX(this.year,4)),e.push(i.vX(this.month,2)),e.push(i.vX(this.day,2)),e.push(i.vX(this.hour,2)),e.push(i.vX(this.minute,2)),e.push(i.vX(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(i.vX(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}re=tt,B.GeneralizedTime=re,tt.NAME="GeneralizedTime";class rt extends je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}ne=rt,B.DATE=ne,rt.NAME="DATE";class nt extends je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}ie=nt,B.TimeOfDay=ie,nt.NAME="TimeOfDay";class it extends je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}se=it,B.DateTime=se,it.NAME="DateTime";class st extends je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}ae=st,B.Duration=ae,st.NAME="Duration";class at extends je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}oe=at,B.TIME=oe,at.NAME="TIME";class ot{constructor({name:e="",optional:t=!1}={}){this.name=e,this.optional=t}}class lt extends ot{constructor({value:e=[],...t}={}){super(t),this.value=e}}class ut extends ot{constructor({value:e=new ot,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class ct{constructor({data:e=d}={}){this.dataView=n.vJ.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=n.vJ.toUint8Array(e)}fromBER(e,t,r){const i=t+r;return this.dataView=n.vJ.toUint8Array(e).subarray(t,i),i}toBER(e){return this.dataView.slice().buffer}}function ht(e,t,r){if(r instanceof lt){for(let n=0;n<r.value.length;n++){if(ht(e,t,r.value[n]).verified)return{verified:!0,result:e}}{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(h)&&(e.name=r.name),e}}if(r instanceof ot)return r.hasOwnProperty(h)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!("isHexOnly"in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(f in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.valueHexView,i=t.idBlock.valueHexView;if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,m),r.name&&(e[r.name]=t)),r instanceof B.Constructed){let n=0,i={verified:!1,result:{error:"Unknown error"}},s=r.valueBlock.value.length;if(s>0&&r.valueBlock.value[0]instanceof ut&&(s=t.valueBlock.value.length),0===s)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,m),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let a=0;a<s;a++)if(a-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[a].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,m),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof ut){if(i=ht(e,t.valueBlock.value[a],r.valueBlock.value[0].value),!1===i.verified){if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,m),r.name&&delete e[r.name]),i;n++}if(h in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[a])}}else if(i=ht(e,t.valueBlock.value[a-n],r.valueBlock.value[a]),!1===i.verified){if(!r.valueBlock.value[a].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,m),r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,m),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&f in t.valueBlock){const n=ue(t.valueBlock.valueHexView);if(-1===n.offset){const t={verified:!1,result:n.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,m),r.name&&(delete e[r.name],t.name=r.name)),t}return ht(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}},766:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,s=l(e),a=s[0],o=s[1],u=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,o)),c=0,h=o>0?a-4:a;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;2===o&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[c++]=255&t);1===o&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],a=16383,o=0,l=n-i;o<l;o+=a)s.push(u(e,o,o+a>l?l:o+a));1===i?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=s.length;a<o;++a)r[a]=s[a],n[s.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,n){for(var i,s,a=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},834:(e,t,r)=>{"use strict";const n=r(766),i=r(333),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=l,t.h2=50;const a=2147483647;function o(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|d(e,t);let n=o(r);const i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(W(e,Uint8Array)){const t=new Uint8Array(e);return m(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(W(e,ArrayBuffer)||e&&W(e.buffer,ArrayBuffer))return m(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(W(e,SharedArrayBuffer)||e&&W(e.buffer,SharedArrayBuffer)))return m(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,r);const i=function(e){if(l.isBuffer(e)){const t=0|g(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||Z(e.length)?o(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return c(e),o(e<0?0:0|g(e))}function f(e){const t=e.length<0?0:0|g(e.length),r=o(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function m(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,l.prototype),n}function g(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function d(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||W(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(i)return n?-1:z(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return x(this,t,r);case"latin1":case"binary":return I(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,i){let s,a=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,o/=2,l/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let n=-1;for(s=r;s<o;s++)if(u(e,s)===u(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===l)return n*a}else-1!==n&&(s-=s-n),n=-1}else for(r+l>o&&(r=o-l),s=r;s>=0;s--){let r=!0;for(let n=0;n<l;n++)if(u(e,s+n)!==u(t,n)){r=!1;break}if(r)return s}return-1}function v(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let a;for(n>s/2&&(n=s/2),a=0;a<n;++a){const n=parseInt(t.substr(2*a,2),16);if(Z(n))return a;e[r+a]=n}return a}function k(e,t,r,n){return q(z(t,e.length-r),e,r,n)}function A(e,t,r,n){return q(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return q(G(t),e,r,n)}function B(e,t,r,n){return q(function(e,t){let r,n,i;const s=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function C(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=r){let r,n,o,l;switch(a){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(s=l));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(l=(15&t)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:r=e[i+1],n=e[i+2],o=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&o)&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&o,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return function(e){const t=e.length;if(t<=N)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=N));return r}(n)}l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),!l.TYPED_ARRAY_SUPPORT&&"undefined"!=typeof console&&console.error,Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return function(e,t,r){return c(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},l.allocUnsafe=function(e){return h(e)},l.allocUnsafeSlow=function(e){return h(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(W(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),W(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=l.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(W(t,Uint8Array))i+t.length>n.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},l.byteLength=d,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):p.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const r=t.h2;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(l.prototype[s]=l.prototype.inspect),l.prototype.compare=function(e,t,r,n,i){if(W(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0);const o=Math.min(s,a),u=this.slice(n,i),c=e.slice(t,r);for(let e=0;e<o;++e)if(u[e]!==c[e]){s=u[e],a=c[e];break}return s<a?-1:a<s?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return k(this,e,t,r);case"ascii":case"latin1":case"binary":return A(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const N=4096;function x(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function I(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function P(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=Q[e[n]];return i}function H(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function V(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,r,n,i,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n,i){K(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function O(e,t,r,n,i){K(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function D(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function T(e,t,r,n,s){return t=+t,r>>>=0,s||D(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function $(e,t,r,n,s){return t=+t,r>>>=0,s||D(e,0,r,8),i.write(e,t,r,n,52,8),r+8}l.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||V(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||V(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||V(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||V(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||V(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||V(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||V(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||M(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||M(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||V(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||V(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return e>>>=0,t||V(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||V(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||V(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||V(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||V(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||M(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||M(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||V(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||V(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||V(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||V(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){L(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){L(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=Y((function(e,t=0){return U(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=Y((function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);L(this,e,t,r,n-1,-n)}let i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);L(this,e,t,r,n-1,-n)}let i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=Y((function(e,t=0){return U(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=Y((function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,r){return T(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return T(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return $(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return $(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},l.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=l.isBuffer(e)?e:l.from(e,n),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%a]}return this};const R={};function j(e,t,r){R[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function _(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function K(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new R.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){F(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||M(t,e.length-(r+1))}(n,i,s)}function F(e,t){if("number"!=typeof e)throw new R.ERR_INVALID_ARG_TYPE(t,"number",e)}function M(e,t,r){if(Math.floor(e)!==e)throw F(e,r),new R.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new R.ERR_BUFFER_OUT_OF_BOUNDS;throw new R.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}j("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),j("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),j("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=_(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=_(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const J=/[^+/0-9A-Za-z-_]/g;function z(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function G(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(J,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function W(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Y(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}},333:(e,t)=>{t.read=function(e,t,r,n,i){var s,a,o=8*i-n-1,l=(1<<o)-1,u=l>>1,c=-7,h=r?i-1:0,f=r?-1:1,m=e[t+h];for(h+=f,s=m&(1<<-c)-1,m>>=-c,c+=o;c>0;s=256*s+e[t+h],h+=f,c-=8);for(a=s&(1<<-c)-1,s>>=-c,c+=n;c>0;a=256*a+e[t+h],h+=f,c-=8);if(0===s)s=1-u;else{if(s===l)return a?NaN:1/0*(m?-1:1);a+=Math.pow(2,n),s-=u}return(m?-1:1)*a*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var a,o,l,u=8*s-i-1,c=(1<<u)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:s-1,g=n?1:-1,d=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?f/l:f*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(o=0,a=c):a+h>=1?(o=(t*l-1)*Math.pow(2,i),a+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+m]=255&o,m+=g,o/=256,i-=8);for(a=a<<i|o,u+=i;u>0;e[r+m]=255&a,m+=g,a/=256,u-=8);e[r+m-g]|=128*d}},287:(e,t,r)=>{"use strict";r.d(t,{Z:()=>ue});var n=r(220),i=r(422);class s{constructor(e={}){this.algorithmId=(0,i.H$)(e,"algorithmId",s.defaultValues("algorithmId")),"algorithmParams"in e&&(this.algorithmParams=(0,i.H$)(e,"algorithmParams",s.defaultValues("algorithmParams"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"algorithmId":return"";case"algorithmParams":return new n.IK;default:throw new Error(`Invalid member name for AlgorithmIdentifier class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"algorithmId":return""===t;case"algorithmParams":return t instanceof n.IK;default:throw new Error(`Invalid member name for AlgorithmIdentifier class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",optional:t.optional||!1,value:[new n.rP({name:t.algorithmIdentifier||""}),new n.IK({name:t.algorithmParams||"",optional:!0})]})}fromSchema(e){(0,i.ze)(e,["algorithm","params"]);const t=n.eN(e,e,s.schema({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AlgorithmIdentifier");this.algorithmId=t.result.algorithm.valueBlock.toString(),"params"in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new n.rP({value:this.algorithmId})),"algorithmParams"in this&&this.algorithmParams instanceof n.IK==!1&&e.push(this.algorithmParams),new n.T9({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return"algorithmParams"in this&&this.algorithmParams instanceof n.IK==!1&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return e instanceof s!=!1&&(this.algorithmId===e.algorithmId&&("algorithmParams"in this?"algorithmParams"in e&&JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!("algorithmParams"in e)))}}class a{static register(e,t,r){this.namedCurves[e.toLowerCase()]=this.namedCurves[t]={name:e,id:t,size:r}}static find(e){return this.namedCurves[e.toLowerCase()]||null}}a.namedCurves={},a.register("P-256","1.2.840.10045.3.1.7",32),a.register("P-384","1.3.132.0.34",48),a.register("P-521","1.3.132.0.35",66),a.register("brainpoolP256r1","1.3.36.3.3.2.8.1.1.7",32),a.register("brainpoolP384r1","1.3.36.3.3.2.8.1.1.11",48),a.register("brainpoolP512r1","1.3.36.3.3.2.8.1.1.13",64);class o{constructor(e={}){this.x=(0,i.H$)(e,"x",o.defaultValues("x")),this.y=(0,i.H$)(e,"y",o.defaultValues("y")),this.namedCurve=(0,i.H$)(e,"namedCurve",o.defaultValues("namedCurve")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"x":case"y":return new ArrayBuffer(0);case"namedCurve":return"";default:throw new Error(`Invalid member name for ECCPublicKey class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"x":case"y":return(0,i.dN)(t,o.defaultValues(e));case"namedCurve":return""===t;default:throw new Error(`Invalid member name for ECCPublicKey class: ${e}`)}}static schema(e={}){return new n.Gh}fromSchema(e){if(e instanceof ArrayBuffer==!1)throw new Error("Object's schema was not verified against input data for ECPublicKey");if(4!==new Uint8Array(e)[0])throw new Error("Object's schema was not verified against input data for ECPublicKey");const t=a.find(this.namedCurve);if(!t)throw new Error(`Incorrect curve OID: ${this.namedCurve}`);const r=t.size;if(e.byteLength!==2*r+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.x=e.slice(1,r+1),this.y=e.slice(1+r,2*r+1)}toSchema(){return new n.Gh({data:(0,i.hk)(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){const e=a.find(this.namedCurve);return{crv:e?e.name:this.namedCurve,x:(0,i.s3)((0,i.lE)(this.x),!0,!0,!1),y:(0,i.s3)((0,i.lE)(this.y),!0,!0,!1)}}fromJSON(e){let t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');{const r=a.find(e.crv);r&&(this.namedCurve=r.id,t=r.size)}if(!("x"in e))throw new Error('Absent mandatory parameter "x"');{const r=(0,i.gG)((0,i.Gh)(e.x,!0));if(r.byteLength<t){this.x=new ArrayBuffer(t);const e=new Uint8Array(this.x),n=new Uint8Array(r);e.set(n,1)}else this.x=r.slice(0,t)}if(!("y"in e))throw new Error('Absent mandatory parameter "y"');{const r=(0,i.gG)((0,i.Gh)(e.y,!0));if(r.byteLength<t){this.y=new ArrayBuffer(t);const e=new Uint8Array(this.y),n=new Uint8Array(r);e.set(n,1)}else this.y=r.slice(0,t)}}}class l{constructor(e={}){this.modulus=(0,i.H$)(e,"modulus",l.defaultValues("modulus")),this.publicExponent=(0,i.H$)(e,"publicExponent",l.defaultValues("publicExponent")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"modulus":case"publicExponent":return new n.z8;default:throw new Error(`Invalid member name for RSAPublicKey class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.z8({name:t.modulus||""}),new n.z8({name:t.publicExponent||""})]})}fromSchema(e){(0,i.ze)(e,["modulus","publicExponent"]);const t=n.eN(e,e,l.schema({names:{modulus:"modulus",publicExponent:"publicExponent"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSAPublicKey");this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new n.T9({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:(0,i.s3)((0,i.lE)(this.modulus.valueBlock.valueHex),!0,!0,!0),e:(0,i.s3)((0,i.lE)(this.publicExponent.valueBlock.valueHex),!0,!0,!0)}}fromJSON(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');{const t=(0,i.gG)((0,i.Gh)(e.n,!0));this.modulus=new n.z8({valueHex:t.slice(0,Math.pow(2,(0,i.J$)(t.byteLength)))})}if(!("e"in e))throw new Error('Absent mandatory parameter "e"');this.publicExponent=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.e,!0)).slice(0,3)})}}class u{constructor(e={}){this.algorithm=(0,i.H$)(e,"algorithm",u.defaultValues("algorithm")),this.subjectPublicKey=(0,i.H$)(e,"subjectPublicKey",u.defaultValues("subjectPublicKey")),"parsedKey"in e&&(this.parsedKey=(0,i.H$)(e,"parsedKey",u.defaultValues("parsedKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"algorithm":return new s;case"subjectPublicKey":return new n._K;default:throw new Error(`Invalid member name for PublicKeyInfo class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[s.schema(t.algorithm||{}),new n._K({name:t.subjectPublicKey||""})]})}fromSchema(e){(0,i.ze)(e,["algorithm","subjectPublicKey"]);const t=n.eN(e,e,u.schema({names:{algorithm:{names:{blockName:"algorithm"}},subjectPublicKey:"subjectPublicKey"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PublicKeyInfo");switch(this.algorithm=new s({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey,this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===n.rP.blockName())try{this.parsedKey=new o({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHex})}catch(e){}break;case"1.2.840.113549.1.1.1":{const e=n.sc(this.subjectPublicKey.valueBlock.valueHex);if(-1!==e.offset)try{this.parsedKey=new l({schema:e.result})}catch(e){}}}}toSchema(){return new n.T9({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if("parsedKey"in this==!1)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();for(const r of Object.keys(t))e[r]=t[r];return e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new o({json:e}),this.algorithm=new s({algorithmId:"1.2.840.10045.2.1",algorithmParams:new n.rP({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new l({json:e}),this.algorithm=new s({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new n.p2});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.subjectPublicKey=new n._K({valueHex:this.parsedKey.toSchema().toBER(!1)})}}importKey(e){let t=Promise.resolve();const r=this;if(void 0===e)return Promise.reject("Need to provide publicKey input parameter");const i=S();return void 0===i?Promise.reject("Unable to create WebCrypto object"):(t=t.then((()=>i.exportKey("spki",e))),t=t.then((e=>{const t=n.sc(e);try{r.fromSchema(t.result)}catch(e){return Promise.reject("Error during initializing object from schema")}}),(e=>Promise.reject(`Error during exporting public key: ${e}`))),t)}}class c{constructor(e={}){this.type=(0,i.H$)(e,"type",c.defaultValues("type")),this.values=(0,i.H$)(e,"values",c.defaultValues("values")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return"";case"values":return[];default:throw new Error(`Invalid member name for Attribute class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":return""===t;case"values":return 0===t.length;default:throw new Error(`Invalid member name for Attribute class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.type||""}),new n.l4({name:t.setName||"",value:[new n.ZD({name:t.values||"",value:new n.IK})]})]})}fromSchema(e){(0,i.ze)(e,["type","values"]);const t=n.eN(e,e,c.schema({names:{type:"type",values:"values"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Attribute");this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new n.T9({value:[new n.rP({value:this.type}),new n.l4({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,(e=>e.toJSON()))}}}class h{constructor(e={}){this.version=(0,i.H$)(e,"version",h.defaultValues("version")),this.privateKey=(0,i.H$)(e,"privateKey",h.defaultValues("privateKey")),"namedCurve"in e&&(this.namedCurve=(0,i.H$)(e,"namedCurve",h.defaultValues("namedCurve"))),"publicKey"in e&&(this.publicKey=(0,i.H$)(e,"publicKey",h.defaultValues("publicKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 1;case"privateKey":return new n.fi;case"namedCurve":return"";case"publicKey":return new o;default:throw new Error(`Invalid member name for ECCPrivateKey class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"version":return t===h.defaultValues(e);case"privateKey":return t.isEqual(h.defaultValues(e));case"namedCurve":return""===t;case"publicKey":return o.compareWithDefault("namedCurve",t.namedCurve)&&o.compareWithDefault("x",t.x)&&o.compareWithDefault("y",t.y);default:throw new Error(`Invalid member name for ECCPrivateKey class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.z8({name:t.version||""}),new n.fi({name:t.privateKey||""}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.rP({name:t.namedCurve||""})]}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new n._K({name:t.publicKey||""})]})]})}fromSchema(e){(0,i.ze)(e,["version","privateKey","namedCurve","publicKey"]);const t=n.eN(e,e,h.schema({names:{version:"version",privateKey:"privateKey",namedCurve:"namedCurve",publicKey:"publicKey"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ECPrivateKey");if(this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,"namedCurve"in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),"publicKey"in t.result){const e={schema:t.result.publicKey.valueBlock.valueHex};"namedCurve"in this&&(e.namedCurve=this.namedCurve),this.publicKey=new o(e)}}toSchema(){const e=[new n.z8({value:this.version}),this.privateKey];return"namedCurve"in this&&e.push(new n.FC({idBlock:{tagClass:3,tagNumber:0},value:[new n.rP({value:this.namedCurve})]})),"publicKey"in this&&e.push(new n.FC({idBlock:{tagClass:3,tagNumber:1},value:[new n._K({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new n.T9({value:e})}toJSON(){if("namedCurve"in this==!1||h.compareWithDefault("namedCurve",this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');let e="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":e="P-256";break;case"1.3.132.0.34":e="P-384";break;case"1.3.132.0.35":e="P-521"}const t={crv:e,d:(0,i.s3)((0,i.lE)(this.privateKey.valueBlock.valueHex),!0,!0,!1)};if("publicKey"in this){const e=this.publicKey.toJSON();t.x=e.x,t.y=e.y}return t}fromJSON(e){let t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');switch(e.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",t=32;break;case"P-384":this.namedCurve="1.3.132.0.34",t=48;break;case"P-521":this.namedCurve="1.3.132.0.35",t=66}if(!("d"in e))throw new Error('Absent mandatory parameter "d"');{const r=(0,i.gG)((0,i.Gh)(e.d,!0));if(r.byteLength<t){const e=new ArrayBuffer(t),i=new Uint8Array(e),s=new Uint8Array(r);i.set(s,1),this.privateKey=new n.fi({valueHex:e})}else this.privateKey=new n.fi({valueHex:r.slice(0,t)})}"x"in e&&"y"in e&&(this.publicKey=new o({json:e}))}}class f{constructor(e={}){this.prime=(0,i.H$)(e,"prime",f.defaultValues("prime")),this.exponent=(0,i.H$)(e,"exponent",f.defaultValues("exponent")),this.coefficient=(0,i.H$)(e,"coefficient",f.defaultValues("coefficient")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"prime":case"exponent":case"coefficient":return new n.z8;default:throw new Error(`Invalid member name for OtherPrimeInfo class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.z8({name:t.prime||""}),new n.z8({name:t.exponent||""}),new n.z8({name:t.coefficient||""})]})}fromSchema(e){(0,i.ze)(e,["prime","exponent","coefficient"]);const t=n.eN(e,e,f.schema({names:{prime:"prime",exponent:"exponent",coefficient:"coefficient"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for OtherPrimeInfo");this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new n.T9({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:(0,i.s3)((0,i.lE)(this.prime.valueBlock.valueHex),!0,!0),d:(0,i.s3)((0,i.lE)(this.exponent.valueBlock.valueHex),!0,!0),t:(0,i.s3)((0,i.lE)(this.coefficient.valueBlock.valueHex),!0,!0)}}fromJSON(e){if(!("r"in e))throw new Error('Absent mandatory parameter "r"');if(this.prime=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.r,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.exponent=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.d,!0))}),!("t"in e))throw new Error('Absent mandatory parameter "t"');this.coefficient=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.t,!0))})}}class m{constructor(e={}){this.version=(0,i.H$)(e,"version",m.defaultValues("version")),this.modulus=(0,i.H$)(e,"modulus",m.defaultValues("modulus")),this.publicExponent=(0,i.H$)(e,"publicExponent",m.defaultValues("publicExponent")),this.privateExponent=(0,i.H$)(e,"privateExponent",m.defaultValues("privateExponent")),this.prime1=(0,i.H$)(e,"prime1",m.defaultValues("prime1")),this.prime2=(0,i.H$)(e,"prime2",m.defaultValues("prime2")),this.exponent1=(0,i.H$)(e,"exponent1",m.defaultValues("exponent1")),this.exponent2=(0,i.H$)(e,"exponent2",m.defaultValues("exponent2")),this.coefficient=(0,i.H$)(e,"coefficient",m.defaultValues("coefficient")),"otherPrimeInfos"in e&&(this.otherPrimeInfos=(0,i.H$)(e,"otherPrimeInfos",m.defaultValues("otherPrimeInfos"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 0;case"modulus":case"publicExponent":case"privateExponent":case"prime1":case"prime2":case"exponent1":case"exponent2":case"coefficient":return new n.z8;case"otherPrimeInfos":return[];default:throw new Error(`Invalid member name for RSAPrivateKey class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.z8({name:t.version||""}),new n.z8({name:t.modulus||""}),new n.z8({name:t.publicExponent||""}),new n.z8({name:t.privateExponent||""}),new n.z8({name:t.prime1||""}),new n.z8({name:t.prime2||""}),new n.z8({name:t.exponent1||""}),new n.z8({name:t.exponent2||""}),new n.z8({name:t.coefficient||""}),new n.T9({optional:!0,value:[new n.ZD({name:t.otherPrimeInfosName||"",value:f.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){(0,i.ze)(e,["version","modulus","publicExponent","privateExponent","prime1","prime2","exponent1","exponent2","coefficient","otherPrimeInfos"]);const t=n.eN(e,e,m.schema({names:{version:"version",modulus:"modulus",publicExponent:"publicExponent",privateExponent:"privateExponent",prime1:"prime1",prime2:"prime2",exponent1:"exponent1",exponent2:"exponent2",coefficient:"coefficient",otherPrimeInfo:{names:{blockName:"otherPrimeInfos"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSAPrivateKey");this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),"otherPrimeInfos"in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,(e=>new f({schema:e}))))}toSchema(){const e=[];return e.push(new n.z8({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),"otherPrimeInfos"in this&&e.push(new n.T9({value:Array.from(this.otherPrimeInfos,(e=>e.toSchema()))})),new n.T9({value:e})}toJSON(){const e={n:(0,i.s3)((0,i.lE)(this.modulus.valueBlock.valueHex),!0,!0,!0),e:(0,i.s3)((0,i.lE)(this.publicExponent.valueBlock.valueHex),!0,!0,!0),d:(0,i.s3)((0,i.lE)(this.privateExponent.valueBlock.valueHex),!0,!0,!0),p:(0,i.s3)((0,i.lE)(this.prime1.valueBlock.valueHex),!0,!0,!0),q:(0,i.s3)((0,i.lE)(this.prime2.valueBlock.valueHex),!0,!0,!0),dp:(0,i.s3)((0,i.lE)(this.exponent1.valueBlock.valueHex),!0,!0,!0),dq:(0,i.s3)((0,i.lE)(this.exponent2.valueBlock.valueHex),!0,!0,!0),qi:(0,i.s3)((0,i.lE)(this.coefficient.valueBlock.valueHex),!0,!0,!0)};return"otherPrimeInfos"in this&&(e.oth=Array.from(this.otherPrimeInfos,(e=>e.toJSON()))),e}fromJSON(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');if(this.modulus=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.n,!0,!0))}),!("e"in e))throw new Error('Absent mandatory parameter "e"');if(this.publicExponent=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.e,!0,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.privateExponent=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.d,!0,!0))}),!("p"in e))throw new Error('Absent mandatory parameter "p"');if(this.prime1=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.p,!0,!0))}),!("q"in e))throw new Error('Absent mandatory parameter "q"');if(this.prime2=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.q,!0,!0))}),!("dp"in e))throw new Error('Absent mandatory parameter "dp"');if(this.exponent1=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.dp,!0,!0))}),!("dq"in e))throw new Error('Absent mandatory parameter "dq"');if(this.exponent2=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.dq,!0,!0))}),!("qi"in e))throw new Error('Absent mandatory parameter "qi"');this.coefficient=new n.z8({valueHex:(0,i.gG)((0,i.Gh)(e.qi,!0,!0))}),"oth"in e&&(this.otherPrimeInfos=Array.from(e.oth,(e=>new f({json:e}))))}}class g{constructor(e={}){this.version=(0,i.H$)(e,"version",g.defaultValues("version")),this.privateKeyAlgorithm=(0,i.H$)(e,"privateKeyAlgorithm",g.defaultValues("privateKeyAlgorithm")),this.privateKey=(0,i.H$)(e,"privateKey",g.defaultValues("privateKey")),"attributes"in e&&(this.attributes=(0,i.H$)(e,"attributes",g.defaultValues("attributes"))),"parsedKey"in e&&(this.parsedKey=(0,i.H$)(e,"parsedKey",g.defaultValues("parsedKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 0;case"privateKeyAlgorithm":return new s;case"privateKey":return new n.fi;case"attributes":return[];case"parsedKey":return{};default:throw new Error(`Invalid member name for PrivateKeyInfo class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.z8({name:t.version||""}),s.schema(t.privateKeyAlgorithm||{}),new n.fi({name:t.privateKey||""}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.ZD({name:t.attributes||"",value:c.schema()})]})]})}fromSchema(e){(0,i.ze)(e,["version","privateKeyAlgorithm","privateKey","attributes"]);const t=n.eN(e,e,g.schema({names:{version:"version",privateKeyAlgorithm:{names:{blockName:"privateKeyAlgorithm"}},privateKey:"privateKey",attributes:"attributes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PrivateKeyInfo");switch(this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new s({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,"attributes"in t.result&&(this.attributes=Array.from(t.result.attributes,(e=>new c({schema:e})))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const e=n.sc(this.privateKey.valueBlock.valueHex);-1!==e.offset&&(this.parsedKey=new m({schema:e.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof n.rP){const e=n.sc(this.privateKey.valueBlock.valueHex);-1!==e.offset&&(this.parsedKey=new h({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:e.result}))}}}toSchema(){const e=[new n.z8({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return"attributes"in this&&e.push(new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,(e=>e.toSchema()))})),new n.T9({value:e})}toJSON(){if("parsedKey"in this==!1){const e={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return"attributes"in this&&(e.attributes=Array.from(this.attributes,(e=>e.toJSON()))),e}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();for(const r of Object.keys(t))e[r]=t[r];return e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new h({json:e}),this.privateKeyAlgorithm=new s({algorithmId:"1.2.840.10045.2.1",algorithmParams:new n.rP({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new m({json:e}),this.privateKeyAlgorithm=new s({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new n.p2});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.privateKey=new n.fi({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}class d{constructor(e={}){if(this.contentType=(0,i.H$)(e,"contentType",d.defaultValues("contentType")),this.contentEncryptionAlgorithm=(0,i.H$)(e,"contentEncryptionAlgorithm",d.defaultValues("contentEncryptionAlgorithm")),"encryptedContent"in e&&(this.encryptedContent=e.encryptedContent,1===this.encryptedContent.idBlock.tagClass&&4===this.encryptedContent.idBlock.tagNumber&&!1===this.encryptedContent.idBlock.isConstructed)){const e=new n.fi({idBlock:{isConstructed:!0},isConstructed:!0});let t=0,r=this.encryptedContent.valueBlock.valueHex.byteLength;for(;r>0;){const i=new Uint8Array(this.encryptedContent.valueBlock.valueHex,t,t+1024>this.encryptedContent.valueBlock.valueHex.byteLength?this.encryptedContent.valueBlock.valueHex.byteLength-t:1024),s=new ArrayBuffer(i.length),a=new Uint8Array(s);for(let e=0;e<a.length;e++)a[e]=i[e];e.valueBlock.value.push(new n.fi({valueHex:s})),r-=i.length,t+=i.length}this.encryptedContent=e}"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"contentType":return"";case"contentEncryptionAlgorithm":return new s;case"encryptedContent":return new n.fi;default:throw new Error(`Invalid member name for EncryptedContentInfo class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"contentType":return""===t;case"contentEncryptionAlgorithm":return""===t.algorithmId&&"algorithmParams"in t==!1;case"encryptedContent":return t.isEqual(d.defaultValues(e));default:throw new Error(`Invalid member name for EncryptedContentInfo class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.contentType||""}),s.schema(t.contentEncryptionAlgorithm||{}),new n.Lv({value:[new n.FC({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0},value:[new n.ZD({value:new n.fi})]}),new n.WV({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){(0,i.ze)(e,["contentType","contentEncryptionAlgorithm","encryptedContent"]);const t=n.eN(e,e,d.schema({names:{contentType:"contentType",contentEncryptionAlgorithm:{names:{blockName:"contentEncryptionAlgorithm"}},encryptedContent:"encryptedContent"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for EncryptedContentInfo");this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new s({schema:t.result.contentEncryptionAlgorithm}),"encryptedContent"in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new n.rP({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),"encryptedContent"in this){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const r=this.encryptedContent;r.idBlock.tagClass=3,r.idBlock.tagNumber=0,r.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(r)}return new n.T9({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return"encryptedContent"in this&&(e.encryptedContent=this.encryptedContent.toJSON()),e}}class p{constructor(e={}){this.hashAlgorithm=(0,i.H$)(e,"hashAlgorithm",p.defaultValues("hashAlgorithm")),this.maskGenAlgorithm=(0,i.H$)(e,"maskGenAlgorithm",p.defaultValues("maskGenAlgorithm")),this.saltLength=(0,i.H$)(e,"saltLength",p.defaultValues("saltLength")),this.trailerField=(0,i.H$)(e,"trailerField",p.defaultValues("trailerField")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"hashAlgorithm":return new s({algorithmId:"1.3.14.3.2.26",algorithmParams:new n.p2});case"maskGenAlgorithm":return new s({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new s({algorithmId:"1.3.14.3.2.26",algorithmParams:new n.p2}).toSchema()});case"saltLength":return 20;case"trailerField":return 1;default:throw new Error(`Invalid member name for RSASSAPSSParams class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.FC({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[s.schema(t.hashAlgorithm||{})]}),new n.FC({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[s.schema(t.maskGenAlgorithm||{})]}),new n.FC({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new n.z8({name:t.saltLength||""})]}),new n.FC({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new n.z8({name:t.trailerField||""})]})]})}fromSchema(e){(0,i.ze)(e,["hashAlgorithm","maskGenAlgorithm","saltLength","trailerField"]);const t=n.eN(e,e,p.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},maskGenAlgorithm:{names:{blockName:"maskGenAlgorithm"}},saltLength:"saltLength",trailerField:"trailerField"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSASSAPSSParams");"hashAlgorithm"in t.result&&(this.hashAlgorithm=new s({schema:t.result.hashAlgorithm})),"maskGenAlgorithm"in t.result&&(this.maskGenAlgorithm=new s({schema:t.result.maskGenAlgorithm})),"saltLength"in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),"trailerField"in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(p.defaultValues("hashAlgorithm"))||e.push(new n.FC({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(p.defaultValues("maskGenAlgorithm"))||e.push(new n.FC({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==p.defaultValues("saltLength")&&e.push(new n.FC({idBlock:{tagClass:3,tagNumber:2},value:[new n.z8({value:this.saltLength})]})),this.trailerField!==p.defaultValues("trailerField")&&e.push(new n.FC({idBlock:{tagClass:3,tagNumber:3},value:[new n.z8({value:this.trailerField})]})),new n.T9({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(p.defaultValues("hashAlgorithm"))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(p.defaultValues("maskGenAlgorithm"))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==p.defaultValues("saltLength")&&(e.saltLength=this.saltLength),this.trailerField!==p.defaultValues("trailerField")&&(e.trailerField=this.trailerField),e}}class y{constructor(e={}){this.salt=(0,i.H$)(e,"salt",y.defaultValues("salt")),this.iterationCount=(0,i.H$)(e,"iterationCount",y.defaultValues("iterationCount")),"keyLength"in e&&(this.keyLength=(0,i.H$)(e,"keyLength",y.defaultValues("keyLength"))),"prf"in e&&(this.prf=(0,i.H$)(e,"prf",y.defaultValues("prf"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"salt":return{};case"iterationCount":return-1;case"keyLength":return 0;case"prf":return new s({algorithmId:"1.3.14.3.2.26",algorithmParams:new n.p2});default:throw new Error(`Invalid member name for PBKDF2Params class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.Lv({value:[new n.fi({name:t.saltPrimitive||""}),s.schema(t.saltConstructed||{})]}),new n.z8({name:t.iterationCount||""}),new n.z8({name:t.keyLength||"",optional:!0}),s.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){(0,i.ze)(e,["salt","iterationCount","keyLength","prf"]);const t=n.eN(e,e,y.schema({names:{saltPrimitive:"salt",saltConstructed:{names:{blockName:"salt"}},iterationCount:"iterationCount",keyLength:"keyLength",prf:{names:{blockName:"prf",optional:!0}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PBKDF2Params");this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,"keyLength"in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),"prf"in t.result&&(this.prf=new s({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new n.z8({value:this.iterationCount})),"keyLength"in this&&y.defaultValues("keyLength")!==this.keyLength&&e.push(new n.z8({value:this.keyLength})),"prf"in this&&!1===y.defaultValues("prf").isEqual(this.prf)&&e.push(this.prf.toSchema()),new n.T9({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return"keyLength"in this&&y.defaultValues("keyLength")!==this.keyLength&&(e.keyLength=this.keyLength),"prf"in this&&!1===y.defaultValues("prf").isEqual(this.prf)&&(e.prf=this.prf.toJSON()),e}}class b{constructor(e={}){this.keyDerivationFunc=(0,i.H$)(e,"keyDerivationFunc",b.defaultValues("keyDerivationFunc")),this.encryptionScheme=(0,i.H$)(e,"encryptionScheme",b.defaultValues("encryptionScheme")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyDerivationFunc":case"encryptionScheme":return new s;default:throw new Error(`Invalid member name for PBES2Params class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[s.schema(t.keyDerivationFunc||{}),s.schema(t.encryptionScheme||{})]})}fromSchema(e){(0,i.ze)(e,["keyDerivationFunc","encryptionScheme"]);const t=n.eN(e,e,b.schema({names:{keyDerivationFunc:{names:{blockName:"keyDerivationFunc"}},encryptionScheme:{names:{blockName:"encryptionScheme"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PBES2Params");this.keyDerivationFunc=new s({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new s({schema:t.result.encryptionScheme})}toSchema(){return new n.T9({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}function w(e,t,r,n,i,s){let a,o;const l=[];switch(t.toUpperCase()){case"SHA-1":a=20,o=64;break;case"SHA-256":a=32,o=64;break;case"SHA-384":a=48,o=128;break;case"SHA-512":a=64,o=128;break;default:throw new Error("Unsupported hashing algorithm")}const u=new Uint8Array(n),c=new ArrayBuffer(2*n.byteLength+2),h=new Uint8Array(c);for(let e=0;e<u.length;e++)h[2*e]=0,h[2*e+1]=u[e];h[h.length-2]=0,h[h.length-1]=0,n=c.slice(0);const f=new ArrayBuffer(o),m=new Uint8Array(f);for(let e=0;e<f.byteLength;e++)m[e]=3;const g=i.byteLength,d=o*Math.ceil(g/o),p=new ArrayBuffer(d),y=new Uint8Array(p),b=new Uint8Array(i);for(let e=0;e<d;e++)y[e]=b[e%g];const w=n.byteLength,v=o*Math.ceil(w/o),k=new ArrayBuffer(v),A=new Uint8Array(k),S=new Uint8Array(n);for(let e=0;e<v;e++)A[e]=S[e%w];const B=p.byteLength+k.byteLength;let C=new ArrayBuffer(B),E=new Uint8Array(C);E.set(y),E.set(A,y.length);const N=Math.ceil((r>>3)/a);let x=Promise.resolve(C);for(let r=0;r<=N;r++){x=x.then((e=>{const t=new ArrayBuffer(f.byteLength+e.byteLength),r=new Uint8Array(t);return r.set(m),r.set(E,m.length),t}));for(let r=0;r<s;r++)x=x.then((r=>e.digest({name:t},new Uint8Array(r))));x=x.then((e=>{const t=new ArrayBuffer(o),r=new Uint8Array(t);for(let n=0;n<t.byteLength;n++)r[n]=e[n%e.length];const n=Math.ceil(g/o)+Math.ceil(w/o),i=[];let s=0,a=o;for(let e=0;e<n;e++){const e=Array.from(new Uint8Array(C.slice(s,s+a)));s+=o,s+o>C.byteLength&&(a=C.byteLength-s);let n=511;for(let i=t.byteLength-1;i>=0;i--)n>>=8,n+=r[i]+e[i],e[i]=255&n;i.push(...e)}return C=new ArrayBuffer(i.length),E=new Uint8Array(C),E.set(i),l.push(...new Uint8Array(e)),C}))}return x=x.then((()=>{const e=new ArrayBuffer(r>>3);return new Uint8Array(e).set(new Uint8Array(l).slice(0,r>>3)),e})),x}class v{constructor(e={}){this.crypto=(0,i.H$)(e,"crypto",{}),this.subtle=(0,i.H$)(e,"subtle",{}),this.name=(0,i.H$)(e,"name","")}importKey(e,t,r,s,a){let o={};switch(t instanceof Uint8Array&&(t=t.buffer),e.toLowerCase()){case"raw":return this.subtle.importKey("raw",t,r,s,a);case"spki":{const e=n.sc(t);if(-1===e.offset)return Promise.reject("Incorrect keyData");const i=new u;try{i.fromSchema(e.result)}catch(e){return Promise.reject("Incorrect keyData")}switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="PS1";break;case"SHA-256":o.alg="PS256";break;case"SHA-384":o.alg="PS384";break;case"SHA-512":o.alg="PS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(a=["verify"],o.kty="RSA",o.ext=s,o.key_ops=a,"1.2.840.113549.1.1.1"!==i.algorithm.algorithmId)return Promise.reject(`Incorrect public key algorithm: ${i.algorithm.algorithmId}`);if("alg"in o==!1)switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RS1";break;case"SHA-256":o.alg="RS256";break;case"SHA-384":o.alg="RS384";break;case"SHA-512":o.alg="RS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const e=i.toJSON();for(const t of Object.keys(e))o[t]=e[t]}break;case"ECDSA":a=["verify"];case"ECDH":{if(o={kty:"EC",ext:s,key_ops:a},"1.2.840.10045.2.1"!==i.algorithm.algorithmId)return Promise.reject(`Incorrect public key algorithm: ${i.algorithm.algorithmId}`);const e=i.toJSON();for(const t of Object.keys(e))o[t]=e[t]}break;case"RSA-OAEP":{if(o.kty="RSA",o.ext=s,o.key_ops=a,"safari"===this.name.toLowerCase())o.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RSA-OAEP";break;case"SHA-256":o.alg="RSA-OAEP-256";break;case"SHA-384":o.alg="RSA-OAEP-384";break;case"SHA-512":o.alg="RSA-OAEP-512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const e=i.toJSON();for(const t of Object.keys(e))o[t]=e[t]}break;case"RSAES-PKCS1-V1_5":{o.kty="RSA",o.ext=s,o.key_ops=a,o.alg="PS1";const e=i.toJSON();for(const t of Object.keys(e))o[t]=e[t]}break;default:return Promise.reject(`Incorrect algorithm name: ${r.name.toUpperCase()}`)}}break;case"pkcs8":{const e=new g,i=n.sc(t);if(-1===i.offset)return Promise.reject("Incorrect keyData");try{e.fromSchema(i.result)}catch(e){return Promise.reject("Incorrect keyData")}if("parsedKey"in e==!1)return Promise.reject("Incorrect keyData");switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="PS1";break;case"SHA-256":o.alg="PS256";break;case"SHA-384":o.alg="PS384";break;case"SHA-512":o.alg="PS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(a=["sign"],o.kty="RSA",o.ext=s,o.key_ops=a,"1.2.840.113549.1.1.1"!==e.privateKeyAlgorithm.algorithmId)return Promise.reject(`Incorrect private key algorithm: ${e.privateKeyAlgorithm.algorithmId}`);if("alg"in o==!1)switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RS1";break;case"SHA-256":o.alg="RS256";break;case"SHA-384":o.alg="RS384";break;case"SHA-512":o.alg="RS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const t=e.toJSON();for(const e of Object.keys(t))o[e]=t[e]}break;case"ECDSA":a=["sign"];case"ECDH":{if(o={kty:"EC",ext:s,key_ops:a},"1.2.840.10045.2.1"!==e.privateKeyAlgorithm.algorithmId)return Promise.reject(`Incorrect algorithm: ${e.privateKeyAlgorithm.algorithmId}`);const t=e.toJSON();for(const e of Object.keys(t))o[e]=t[e]}break;case"RSA-OAEP":{if(o.kty="RSA",o.ext=s,o.key_ops=a,"safari"===this.name.toLowerCase())o.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RSA-OAEP";break;case"SHA-256":o.alg="RSA-OAEP-256";break;case"SHA-384":o.alg="RSA-OAEP-384";break;case"SHA-512":o.alg="RSA-OAEP-512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const t=e.toJSON();for(const e of Object.keys(t))o[e]=t[e]}break;case"RSAES-PKCS1-V1_5":{a=["decrypt"],o.kty="RSA",o.ext=s,o.key_ops=a,o.alg="PS1";const t=e.toJSON();for(const e of Object.keys(t))o[e]=t[e]}break;default:return Promise.reject(`Incorrect algorithm name: ${r.name.toUpperCase()}`)}}break;case"jwk":o=t;break;default:return Promise.reject(`Incorrect format: ${e}`)}return"safari"===this.name.toLowerCase()?Promise.resolve().then((()=>this.subtle.importKey("jwk",(0,i.gG)(JSON.stringify(o)),r,s,a))).then((e=>e),(()=>this.subtle.importKey("jwk",o,r,s,a))):this.subtle.importKey("jwk",o,r,s,a)}exportKey(e,t){let r=this.subtle.exportKey("jwk",t);switch("safari"===this.name.toLowerCase()&&(r=r.then((e=>e instanceof ArrayBuffer?JSON.parse((0,i.lE)(e)):e))),e.toLowerCase()){case"raw":return this.subtle.exportKey("raw",t);case"spki":r=r.then((e=>{const t=new u;try{t.fromJSON(e)}catch(e){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)}));break;case"pkcs8":r=r.then((e=>{const t=new g;try{t.fromJSON(e)}catch(e){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)}));break;case"jwk":break;default:return Promise.reject(`Incorrect format: ${e}`)}return r}convert(e,t,r,n,i,s){switch(e.toLowerCase()){case"raw":switch(t.toLowerCase()){case"raw":return Promise.resolve(r);case"spki":return Promise.resolve().then((()=>this.importKey("raw",r,n,i,s))).then((e=>this.exportKey("spki",e)));case"pkcs8":return Promise.resolve().then((()=>this.importKey("raw",r,n,i,s))).then((e=>this.exportKey("pkcs8",e)));case"jwk":return Promise.resolve().then((()=>this.importKey("raw",r,n,i,s))).then((e=>this.exportKey("jwk",e)));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"spki":switch(t.toLowerCase()){case"raw":return Promise.resolve().then((()=>this.importKey("spki",r,n,i,s))).then((e=>this.exportKey("raw",e)));case"spki":return Promise.resolve(r);case"pkcs8":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"jwk":return Promise.resolve().then((()=>this.importKey("spki",r,n,i,s))).then((e=>this.exportKey("jwk",e)));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"pkcs8":switch(t.toLowerCase()){case"raw":return Promise.resolve().then((()=>this.importKey("pkcs8",r,n,i,s))).then((e=>this.exportKey("raw",e)));case"spki":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"pkcs8":return Promise.resolve(r);case"jwk":return Promise.resolve().then((()=>this.importKey("pkcs8",r,n,i,s))).then((e=>this.exportKey("jwk",e)));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"jwk":switch(t.toLowerCase()){case"raw":return Promise.resolve().then((()=>this.importKey("jwk",r,n,i,s))).then((e=>this.exportKey("raw",e)));case"spki":return Promise.resolve().then((()=>this.importKey("jwk",r,n,i,s))).then((e=>this.exportKey("spki",e)));case"pkcs8":return Promise.resolve().then((()=>this.importKey("jwk",r,n,i,s))).then((e=>this.exportKey("pkcs8",e)));case"jwk":return Promise.resolve(r);default:return Promise.reject(`Incorrect outputFormat: ${t}`)}default:return Promise.reject(`Incorrect inputFormat: ${e}`)}}encrypt(...e){return this.subtle.encrypt(...e)}decrypt(...e){return this.subtle.decrypt(...e)}sign(...e){return this.subtle.sign(...e)}verify(...e){return this.subtle.verify(...e)}digest(...e){return this.subtle.digest(...e)}generateKey(...e){return this.subtle.generateKey(...e)}deriveKey(...e){return this.subtle.deriveKey(...e)}deriveBits(...e){return this.subtle.deriveBits(...e)}wrapKey(...e){return this.subtle.wrapKey(...e)}unwrapKey(...e){return this.subtle.unwrapKey(...e)}getRandomValues(e){if("getRandomValues"in this.crypto==!1)throw new Error("No support for getRandomValues");return this.crypto.getRandomValues(e)}getAlgorithmByOID(e){switch(e){case"1.2.840.113549.1.1.1":return{name:"RSAES-PKCS1-v1_5"};case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}return{}}getOIDByAlgorithm(e){let t="";switch(e.name.toUpperCase()){case"RSAES-PKCS1-V1_5":t="1.2.840.113549.1.1.1";break;case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.1.1.5";break;case"SHA-256":t="1.2.840.113549.1.1.11";break;case"SHA-384":t="1.2.840.113549.1.1.12";break;case"SHA-512":t="1.2.840.113549.1.1.13"}break;case"RSA-PSS":t="1.2.840.113549.1.1.10";break;case"RSA-OAEP":t="1.2.840.113549.1.1.7";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.10045.4.1";break;case"SHA-256":t="1.2.840.10045.4.3.2";break;case"SHA-384":t="1.2.840.10045.4.3.3";break;case"SHA-512":t="1.2.840.10045.4.3.4"}break;case"ECDH":switch(e.kdf.toUpperCase()){case"SHA-1":t="1.3.133.16.840.63.0.2";break;case"SHA-256":t="1.3.132.1.11.1";break;case"SHA-384":t="1.3.132.1.11.2";break;case"SHA-512":t="1.3.132.1.11.3"}break;case"AES-CTR":case"AES-CMAC":case"CONCAT":case"HKDF":break;case"AES-CBC":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.2";break;case 192:t="2.16.840.1.101.3.4.1.22";break;case 256:t="2.16.840.1.101.3.4.1.42"}break;case"AES-GCM":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.6";break;case 192:t="2.16.840.1.101.3.4.1.26";break;case 256:t="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.4";break;case 192:t="2.16.840.1.101.3.4.1.24";break;case 256:t="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.5";break;case 192:t="2.16.840.1.101.3.4.1.25";break;case 256:t="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.2.7";break;case"SHA-256":t="1.2.840.113549.2.9";break;case"SHA-384":t="1.2.840.113549.2.10";break;case"SHA-512":t="1.2.840.113549.2.11"}break;case"DH":t="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":t="1.3.14.3.2.26";break;case"SHA-256":t="2.16.840.1.101.3.4.2.1";break;case"SHA-384":t="2.16.840.1.101.3.4.2.2";break;case"SHA-512":t="2.16.840.1.101.3.4.2.3";break;case"PBKDF2":t="1.2.840.113549.1.5.12";break;case"P-256":t="1.2.840.10045.3.1.7";break;case"P-384":t="1.3.132.0.34";break;case"P-521":t="1.3.132.0.35"}return t}getAlgorithmParameters(e,t){let r={algorithm:{},usages:[]};switch(e.toUpperCase()){case"RSAES-PKCS1-V1_5":case"RSASSA-PKCS1-V1_5":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":r={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(t.toLowerCase()){case"encrypt":case"decrypt":r={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":r={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":r={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":r={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(t.toLowerCase()){case"exportkey":case"importkey":case"generatekey":r={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":r={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":r={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":if("derivekey"!==t.toLowerCase())return{algorithm:{name:"HKDF"},usages:[]};r={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;case"PBKDF2":if("derivekey"!==t.toLowerCase())return{algorithm:{name:"PBKDF2"},usages:[]};r={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]}}return r}getHashAlgorithm(e){let t="";switch(e.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":t="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":t="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":t="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":t="SHA-512";break;case"1.2.840.113549.1.1.10":try{const r=new p({schema:e.algorithmParams});if("hashAlgorithm"in r){const e=this.getAlgorithmByOID(r.hashAlgorithm.algorithmId);if("name"in e==!1)return"";t=e.name}else t="SHA-1"}catch(e){}}return t}encryptEncryptedContentInfo(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("contentEncryptionAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "contentEncryptionAlgorithm"');if("hmacHashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hmacHashAlgorithm"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("contentToEncrypt"in e==!1)return Promise.reject('Absent mandatory parameter "contentToEncrypt"');if("contentType"in e==!1)return Promise.reject('Absent mandatory parameter "contentType"');const t=this.getOIDByAlgorithm(e.contentEncryptionAlgorithm);if(""===t)return Promise.reject('Wrong "contentEncryptionAlgorithm" value');const r=this.getOIDByAlgorithm({name:"PBKDF2"});if(""===r)return Promise.reject("Can not find OID for PBKDF2");const i=this.getOIDByAlgorithm({name:"HMAC",hash:{name:e.hmacHashAlgorithm}});if(""===i)return Promise.reject(`Incorrect value for "hmacHashAlgorithm": ${e.hmacHashAlgorithm}`);let a=Promise.resolve();const o=new ArrayBuffer(16),l=new Uint8Array(o);this.getRandomValues(l);const u=new ArrayBuffer(64),c=new Uint8Array(u);this.getRandomValues(c);const h=new Uint8Array(e.contentToEncrypt),f=new y({salt:new n.fi({valueHex:u}),iterationCount:e.iterationCount,prf:new s({algorithmId:i,algorithmParams:new n.p2})});return a=a.then((()=>{const t=new Uint8Array(e.password);return this.importKey("raw",t,"PBKDF2",!1,["deriveKey"])}),(e=>Promise.reject(e))),a=a.then((t=>this.deriveKey({name:"PBKDF2",hash:{name:e.hmacHashAlgorithm},salt:c,iterations:e.iterationCount},t,e.contentEncryptionAlgorithm,!1,["encrypt"])),(e=>Promise.reject(e))),a=a.then((t=>this.encrypt({name:e.contentEncryptionAlgorithm.name,iv:l},t,h)),(e=>Promise.reject(e))),a=a.then((i=>{const a=new b({keyDerivationFunc:new s({algorithmId:r,algorithmParams:f.toSchema()}),encryptionScheme:new s({algorithmId:t,algorithmParams:new n.fi({valueHex:o})})});return new d({contentType:e.contentType,contentEncryptionAlgorithm:new s({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:a.toSchema()}),encryptedContent:new n.fi({valueHex:i})})}),(e=>Promise.reject(e))),a}decryptEncryptedContentInfo(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("encryptedContentInfo"in e==!1)return Promise.reject('Absent mandatory parameter "encryptedContentInfo"');if("1.2.840.113549.1.5.13"!==e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId)return Promise.reject(`Unknown "contentEncryptionAlgorithm": ${e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);let t,r,n=Promise.resolve();try{t=new b({schema:e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "pbes2Parameters"')}try{r=new y({schema:t.keyDerivationFunc.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "pbkdf2Params"')}const s=this.getAlgorithmByOID(t.encryptionScheme.algorithmId);if("name"in s==!1)return Promise.reject(`Incorrect OID for "contentEncryptionAlgorithm": ${t.encryptionScheme.algorithmId}`);const a=t.encryptionScheme.algorithmParams.valueBlock.valueHex,o=new Uint8Array(a),l=r.salt.valueBlock.valueHex,u=new Uint8Array(l),c=r.iterationCount;let h="SHA-1";if("prf"in r){const e=this.getAlgorithmByOID(r.prf.algorithmId);if("name"in e==!1)return Promise.reject("Incorrect OID for HMAC hash algorithm");h=e.hash.name}return n=n.then((()=>this.importKey("raw",e.password,"PBKDF2",!1,["deriveKey"])),(e=>Promise.reject(e))),n=n.then((e=>this.deriveKey({name:"PBKDF2",hash:{name:h},salt:u,iterations:c},e,s,!1,["decrypt"])),(e=>Promise.reject(e))),n=n.then((t=>{let r=new ArrayBuffer(0);if(!1===e.encryptedContentInfo.encryptedContent.idBlock.isConstructed)r=e.encryptedContentInfo.encryptedContent.valueBlock.valueHex;else for(const t of e.encryptedContentInfo.encryptedContent.valueBlock.value)r=(0,i.hk)(r,t.valueBlock.valueHex);return this.decrypt({name:s.name,iv:o},t,r)}),(e=>Promise.reject(e))),n}stampDataWithPassword(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "salt"');if("contentToStamp"in e==!1)return Promise.reject('Absent mandatory parameter "contentToStamp"');let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:return Promise.reject(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}let r=Promise.resolve();const n={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}};return r=r.then((()=>w(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount))),r=r.then((e=>this.importKey("raw",new Uint8Array(e),n,!1,["sign"]))),r=r.then((t=>this.sign(n,t,new Uint8Array(e.contentToStamp))),(e=>Promise.reject(e))),r}verifyDataStampedWithPassword(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "salt"');if("contentToVerify"in e==!1)return Promise.reject('Absent mandatory parameter "contentToVerify"');if("signatureToVerify"in e==!1)return Promise.reject('Absent mandatory parameter "signatureToVerify"');let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:return Promise.reject(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}let r=Promise.resolve();const n={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}};return r=r.then((()=>w(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount))),r=r.then((e=>this.importKey("raw",new Uint8Array(e),n,!1,["verify"]))),r=r.then((t=>this.verify(n,t,new Uint8Array(e.signatureToVerify),new Uint8Array(e.contentToVerify))),(e=>Promise.reject(e))),r}getSignatureParameters(e,t="SHA-1"){if(""===this.getOIDByAlgorithm({name:t}))return Promise.reject(`Unsupported hash algorithm: ${t}`);const r=new s,i=this.getAlgorithmParameters(e.algorithm.name,"sign");switch(i.algorithm.hash.name=t,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":r.algorithmId=this.getOIDByAlgorithm(i.algorithm);break;case"RSA-PSS":{switch(t.toUpperCase()){case"SHA-256":i.algorithm.saltLength=32;break;case"SHA-384":i.algorithm.saltLength=48;break;case"SHA-512":i.algorithm.saltLength=64}const e={};if("SHA-1"!==t.toUpperCase()){const r=this.getOIDByAlgorithm({name:t});if(""===r)return Promise.reject(`Unsupported hash algorithm: ${t}`);e.hashAlgorithm=new s({algorithmId:r,algorithmParams:new n.p2}),e.maskGenAlgorithm=new s({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:e.hashAlgorithm.toSchema()})}20!==i.algorithm.saltLength&&(e.saltLength=i.algorithm.saltLength);const a=new p(e);r.algorithmId="1.2.840.113549.1.1.10",r.algorithmParams=a.toSchema()}break;default:return Promise.reject(`Unsupported signature algorithm: ${e.algorithm.name}`)}return Promise.resolve().then((()=>({signatureAlgorithm:r,parameters:i})))}signWithPrivateKey(e,t,r){return this.sign(r.algorithm,t,new Uint8Array(e)).then((e=>("ECDSA"===r.algorithm.name&&(e=function(e){if(e.byteLength%2!=0)return new ArrayBuffer(0);const t=e.byteLength/2,r=new ArrayBuffer(t);new Uint8Array(r).set(new Uint8Array(e,0,t));const i=new n.z8({valueHex:r}),s=new ArrayBuffer(t);new Uint8Array(s).set(new Uint8Array(e,t,t));const a=new n.z8({valueHex:s});return new n.T9({value:[i.convertToDER(),a.convertToDER()]}).toBER(!1)}(e)),e)),(e=>Promise.reject(`Signing error: ${e}`)))}fillPublicKeyParameters(e,t){const r={},n=this.getHashAlgorithm(t);if(""===n)return Promise.reject(`Unsupported signature algorithm: ${t.algorithmId}`);let i;i="1.2.840.113549.1.1.10"===t.algorithmId?t.algorithmId:e.algorithm.algorithmId;const s=this.getAlgorithmByOID(i);if("name"in s==="")return Promise.reject(`Unsupported public key algorithm: ${t.algorithmId}`);if(r.algorithm=this.getAlgorithmParameters(s.name,"importkey"),"hash"in r.algorithm.algorithm&&(r.algorithm.algorithm.hash.name=n),"ECDSA"===s.name){let t=!1;if("algorithmParams"in e.algorithm==!0&&"idBlock"in e.algorithm.algorithmParams&&1===e.algorithm.algorithmParams.idBlock.tagClass&&6===e.algorithm.algorithmParams.idBlock.tagNumber&&(t=!0),!1===t)return Promise.reject("Incorrect type for ECDSA public key parameters");const n=this.getAlgorithmByOID(e.algorithm.algorithmParams.valueBlock.toString());if("name"in n==!1)return Promise.reject(`Unsupported named curve algorithm: ${e.algorithm.algorithmParams.valueBlock.toString()}`);r.algorithm.algorithm.namedCurve=n.name}return r}getPublicKey(e,t,r=null){null===r&&(r=this.fillPublicKeyParameters(e,t));const n=e.toSchema().toBER(!1),i=new Uint8Array(n);return this.importKey("spki",i,r.algorithm.algorithm,!0,r.algorithm.usages)}verifyWithPublicKey(e,t,r,s,a=null){let o=Promise.resolve();if(null===a){if(""===(a=this.getHashAlgorithm(s)))return Promise.reject(`Unsupported signature algorithm: ${s.algorithmId}`);o=o.then((()=>this.getPublicKey(r,s)))}else{const e={};let t;t="1.2.840.113549.1.1.10"===s.algorithmId?s.algorithmId:r.algorithm.algorithmId;const n=this.getAlgorithmByOID(t);if("name"in n==="")return Promise.reject(`Unsupported public key algorithm: ${s.algorithmId}`);if(e.algorithm=this.getAlgorithmParameters(n.name,"importkey"),"hash"in e.algorithm.algorithm&&(e.algorithm.algorithm.hash.name=a),"ECDSA"===n.name){let t=!1;if("algorithmParams"in r.algorithm==!0&&"idBlock"in r.algorithm.algorithmParams&&1===r.algorithm.algorithmParams.idBlock.tagClass&&6===r.algorithm.algorithmParams.idBlock.tagNumber&&(t=!0),!1===t)return Promise.reject("Incorrect type for ECDSA public key parameters");const n=this.getAlgorithmByOID(r.algorithm.algorithmParams.valueBlock.toString());if("name"in n==!1)return Promise.reject(`Unsupported named curve algorithm: ${r.algorithm.algorithmParams.valueBlock.toString()}`);e.algorithm.algorithm.namedCurve=n.name}o=o.then((()=>this.getPublicKey(r,null,e)))}return o=o.then((r=>{const o=this.getAlgorithmParameters(r.algorithm.name,"verify");"hash"in o.algorithm&&(o.algorithm.hash.name=a);let l=t.valueBlock.valueHex;if("ECDSA"===r.algorithm.name){l=function(e){if(e instanceof n.T9==!1)return new ArrayBuffer(0);if(2!==e.valueBlock.value.length)return new ArrayBuffer(0);if(e.valueBlock.value[0]instanceof n.z8==!1)return new ArrayBuffer(0);if(e.valueBlock.value[1]instanceof n.z8==!1)return new ArrayBuffer(0);const t=e.valueBlock.value[0].convertFromDER(),r=e.valueBlock.value[1].convertFromDER();switch(!0){case t.valueBlock.valueHex.byteLength<r.valueBlock.valueHex.byteLength:{if(r.valueBlock.valueHex.byteLength-t.valueBlock.valueHex.byteLength!=1)throw new Error("Incorrect DER integer decoding");const e=r.valueBlock.valueHex.byteLength,n=new Uint8Array(t.valueBlock.valueHex),s=new ArrayBuffer(e),a=new Uint8Array(s);return a.set(n,1),a[0]=0,(0,i.hk)(s,r.valueBlock.valueHex)}case t.valueBlock.valueHex.byteLength>r.valueBlock.valueHex.byteLength:{if(t.valueBlock.valueHex.byteLength-r.valueBlock.valueHex.byteLength!=1)throw new Error("Incorrect DER integer decoding");const e=t.valueBlock.valueHex.byteLength,n=new Uint8Array(r.valueBlock.valueHex),s=new ArrayBuffer(e),a=new Uint8Array(s);return a.set(n,1),a[0]=0,(0,i.hk)(t.valueBlock.valueHex,s)}default:if(t.valueBlock.valueHex.byteLength%2){const e=t.valueBlock.valueHex.byteLength+1,n=new Uint8Array(t.valueBlock.valueHex),s=new ArrayBuffer(e),a=new Uint8Array(s);a.set(n,1),a[0]=0;const o=new Uint8Array(r.valueBlock.valueHex),l=new ArrayBuffer(e),u=new Uint8Array(l);return u.set(o,1),u[0]=0,(0,i.hk)(s,l)}}return(0,i.hk)(t.valueBlock.valueHex,r.valueBlock.valueHex)}(n.sc(l).result)}if("RSA-PSS"===r.algorithm.name){let e;try{e=new p({schema:s.algorithmParams})}catch(e){return Promise.reject(e)}o.algorithm.saltLength="saltLength"in e?e.saltLength:20;let t="SHA-1";if("hashAlgorithm"in e){const r=this.getAlgorithmByOID(e.hashAlgorithm.algorithmId);if("name"in r==!1)return Promise.reject(`Unrecognized hash algorithm: ${e.hashAlgorithm.algorithmId}`);t=r.name}o.algorithm.hash.name=t}return this.verify(o.algorithm,r,new Uint8Array(l),new Uint8Array(e))})),o}}let k={name:"none",crypto:null,subtle:null};function A(){if("undefined"!=typeof process&&"pid"in process&&void 0!==r.g&&"undefined"==typeof window){let e;try{e=r.g[process.pid].pkijs.engine}catch(e){throw new Error('Please call "setEngine" before call to "getEngine"')}return e}return k}function S(){const e=A();if(null!==e.subtle)return e.subtle}function B(e){let t=!1,r="";const n=e.trim();for(let e=0;e<n.length;e++)32===n.charCodeAt(e)?!1===t&&(t=!0):(t&&(r+=" ",t=!1),r+=n[e]);return r.toLowerCase()}!function(){if("undefined"!=typeof self&&"crypto"in self){let e="webcrypto";const t=self.crypto;let r;if("webkitSubtle"in self.crypto){try{r=self.crypto.webkitSubtle}catch(e){r=self.crypto.subtle}e="safari"}"subtle"in self.crypto&&(r=self.crypto.subtle),k=void 0===r?{name:e,crypto:t,subtle:null}:{name:e,crypto:t,subtle:new v({name:e,crypto:self.crypto,subtle:r})}}!function(e,t,n){if("undefined"!=typeof process&&"pid"in process&&void 0!==r.g&&"undefined"==typeof window){if(void 0===r.g[process.pid])r.g[process.pid]={};else if("object"!=typeof r.g[process.pid])throw new Error(`Name global.${process.pid} already exists and it is not an object`);if(void 0===r.g[process.pid].pkijs)r.g[process.pid].pkijs={};else if("object"!=typeof r.g[process.pid].pkijs)throw new Error(`Name global.${process.pid}.pkijs already exists and it is not an object`);r.g[process.pid].pkijs.engine={name:e,crypto:t,subtle:n}}else k.name!==e&&(k={name:e,crypto:t,subtle:n})}(k.name,k.crypto,k.subtle)}();class C{constructor(e={}){this.type=(0,i.H$)(e,"type",C.defaultValues("type")),this.value=(0,i.H$)(e,"value",C.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return"";case"value":return{};default:throw new Error(`Invalid member name for AttributeTypeAndValue class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.type||""}),new n.IK({name:t.value||""})]})}static blockName(){return"AttributeTypeAndValue"}fromSchema(e){(0,i.ze)(e,["type","typeValue"]);const t=n.eN(e,e,C.schema({names:{type:"type",value:"typeValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AttributeTypeAndValue");this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new n.T9({value:[new n.rP({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return 0!==Object.keys(this.value).length?e.value=this.value.toJSON():e.value=this.value,e}isEqual(e){const t=[n.qU.blockName(),n.kE.blockName(),n.GM.blockName(),n.Tz.blockName(),n.Ox.blockName(),n.gF.blockName(),n.SZ.blockName(),n.$.blockName(),n.HQ.blockName(),n.NI.blockName(),n.EI.blockName(),n.Hk.blockName()];if(e.constructor.blockName()===C.blockName()){if(this.type!==e.type)return!1;let r=[!1,!1];const n=this.value.constructor.blockName();for(const i of t)n===i&&(r[0]=!0),e.value.constructor.blockName()===i&&(r[1]=!0);if(r[0]^r[1])return!1;if(r=r[0]&&r[1],r){const t=B(this.value.valueBlock.value),r=B(e.value.valueBlock.value);if(0!==t.localeCompare(r))return!1}else if(!1===(0,i.dN)(this.value.valueBeforeDecode,e.value.valueBeforeDecode))return!1;return!0}return e instanceof ArrayBuffer&&(0,i.dN)(this.value.valueBeforeDecode,e)}}class E{constructor(e={}){this.typesAndValues=(0,i.H$)(e,"typesAndValues",E.defaultValues("typesAndValues")),this.valueBeforeDecode=(0,i.H$)(e,"valueBeforeDecode",E.defaultValues("valueBeforeDecode")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"typesAndValues":return[];case"valueBeforeDecode":return new ArrayBuffer(0);default:throw new Error(`Invalid member name for RelativeDistinguishedNames class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"typesAndValues":return 0===t.length;case"valueBeforeDecode":return 0===t.byteLength;default:throw new Error(`Invalid member name for RelativeDistinguishedNames class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ZD({name:t.repeatedSequence||"",value:new n.l4({value:[new n.ZD({name:t.repeatedSet||"",value:C.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){(0,i.ze)(e,["RDN","typesAndValues"]);const t=n.eN(e,e,E.schema({names:{blockName:"RDN",repeatedSet:"typesAndValues"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RelativeDistinguishedNames");"typesAndValues"in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,(e=>new C({schema:e})))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecode}toSchema(){if(0===this.valueBeforeDecode.byteLength)return new n.T9({value:[new n.l4({value:Array.from(this.typesAndValues,(e=>e.toSchema()))})]});return n.sc(this.valueBeforeDecode).result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,(e=>e.toJSON()))}}isEqual(e){if(e instanceof E){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;for(const[t,r]of this.typesAndValues.entries())if(!1===r.isEqual(e.typesAndValues[t]))return!1;return!0}return e instanceof ArrayBuffer&&(0,i.dN)(this.valueBeforeDecode,e)}}class N{constructor(e={}){this.type=(0,i.H$)(e,"type",N.defaultValues("type")),this.value=(0,i.H$)(e,"value",N.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return 0;case"value":return new Date(0,0,0);default:throw new Error(`Invalid member name for Time class: ${e}`)}}static schema(e={},t=!1){const r=(0,i.H$)(e,"names",{});return new n.Lv({optional:t,value:[new n.BD({name:r.utcTimeName||""}),new n.Yw({name:r.generalTimeName||""})]})}fromSchema(e){(0,i.ze)(e,["utcTimeName","generalTimeName"]);const t=n.eN(e,e,N.schema({names:{utcTimeName:"utcTimeName",generalTimeName:"generalTimeName"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Time");"utcTimeName"in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),"generalTimeName"in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){let e={};return 0===this.type&&(e=new n.BD({valueDate:this.value})),1===this.type&&(e=new n.Yw({valueDate:this.value})),e}toJSON(){return{type:this.type,value:this.value}}}class x{constructor(e={}){this.attributes=(0,i.H$)(e,"attributes",x.defaultValues("attributes")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("attributes"===e)return[];throw new Error(`Invalid member name for SubjectDirectoryAttributes class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ZD({name:t.attributes||"",value:c.schema()})]})}fromSchema(e){(0,i.ze)(e,["attributes"]);const t=n.eN(e,e,x.schema({names:{attributes:"attributes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for SubjectDirectoryAttributes");this.attributes=Array.from(t.result.attributes,(e=>new c({schema:e})))}toSchema(){return new n.T9({value:Array.from(this.attributes,(e=>e.toSchema()))})}toJSON(){return{attributes:Array.from(this.attributes,(e=>e.toJSON()))}}}class I{constructor(e={}){"notBefore"in e&&(this.notBefore=(0,i.H$)(e,"notBefore",I.defaultValues("notBefore"))),"notAfter"in e&&(this.notAfter=(0,i.H$)(e,"notAfter",I.defaultValues("notAfter"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"notBefore":case"notAfter":return new Date;default:throw new Error(`Invalid member name for PrivateKeyUsagePeriod class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.WV({name:t.notBefore||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new n.WV({name:t.notAfter||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){(0,i.ze)(e,["notBefore","notAfter"]);const t=n.eN(e,e,I.schema({names:{notBefore:"notBefore",notAfter:"notAfter"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PrivateKeyUsagePeriod");if("notBefore"in t.result){const e=new n.Yw;e.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=e.toDate()}if("notAfter"in t.result){const e=new n.Yw({valueHex:t.result.notAfter.valueBlock.valueHex});e.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=e.toDate()}}toSchema(){const e=[];return"notBefore"in this&&e.push(new n.WV({idBlock:{tagClass:3,tagNumber:0},valueHex:new n.Yw({valueDate:this.notBefore}).valueBlock.valueHex})),"notAfter"in this&&e.push(new n.WV({idBlock:{tagClass:3,tagNumber:1},valueHex:new n.Yw({valueDate:this.notAfter}).valueBlock.valueHex})),new n.T9({value:e})}toJSON(){const e={};return"notBefore"in this&&(e.notBefore=this.notBefore),"notAfter"in this&&(e.notAfter=this.notAfter),e}}function P(e={},t=!1){const r=(0,i.H$)(e,"names",{});return new n.T9({optional:t,value:[new n.FC({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:r.country_name||"",value:[new n.Lv({value:[new n.Tz,new n.Ox]})]}),new n.FC({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:r.administration_domain_name||"",value:[new n.Lv({value:[new n.Tz,new n.Ox]})]}),new n.WV({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:r.network_address||"",isHexOnly:!0}),new n.WV({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:r.terminal_identifier||"",isHexOnly:!0}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:r.private_domain_name||"",value:[new n.Lv({value:[new n.Tz,new n.Ox]})]}),new n.WV({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:r.organization_name||"",isHexOnly:!0}),new n.WV({optional:!0,name:r.numeric_user_identifier||"",idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new n.FC({optional:!0,name:r.personal_name||"",idBlock:{tagClass:3,tagNumber:5},value:[new n.WV({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new n.WV({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new n.WV({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new n.WV({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new n.FC({optional:!0,name:r.organizational_unit_names||"",idBlock:{tagClass:3,tagNumber:6},value:[new n.ZD({value:new n.Ox})]})]})}function H(e=!1){return new n.T9({optional:e,value:[new n.Ox,new n.Ox]})}function V(e=!1){return new n.l4({optional:e,value:[new n.WV({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new n.IK]})]})}class L{constructor(e={}){this.type=(0,i.H$)(e,"type",L.defaultValues("type")),this.value=(0,i.H$)(e,"value",L.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return 9;case"value":return{};default:throw new Error(`Invalid member name for GeneralName class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":return t===L.defaultValues(e);case"value":return 0===Object.keys(t).length;default:throw new Error(`Invalid member name for GeneralName class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.Lv({value:[new n.FC({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||"",value:[new n.rP,new n.FC({idBlock:{tagClass:3,tagNumber:0},value:[new n.IK]})]}),new n.WV({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:1}}),new n.WV({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:2}}),new n.FC({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||"",value:[P(t.builtInStandardAttributes||{},!1),H(!0),V(!0)]}),new n.FC({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||"",value:[E.schema(t.directoryName||{})]}),new n.FC({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||"",value:[new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.Lv({value:[new n.gF,new n.Ox,new n.GM,new n.qU,new n.kE]})]}),new n.FC({idBlock:{tagClass:3,tagNumber:1},value:[new n.Lv({value:[new n.gF,new n.Ox,new n.GM,new n.qU,new n.kE]})]})]}),new n.WV({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:6}}),new n.WV({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:7}}),new n.WV({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){(0,i.ze)(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=n.eN(e,e,L.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralName");switch(this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:case 3:this.value=t.result.blockName;break;case 1:case 2:case 6:{const e=t.result.blockName;e.idBlock.tagClass=1,e.idBlock.tagNumber=22;const r=e.toBER(!1);this.value=n.sc(r).result.valueBlock.value}break;case 4:this.value=new E({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new n.fi({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const e=t.result.blockName;e.idBlock.tagClass=1,e.idBlock.tagNumber=6;const r=e.toBER(!1);this.value=n.sc(r).result.valueBlock.toString()}}}toSchema(){switch(this.type){case 0:case 3:case 5:return new n.FC({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new n.$({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new n.FC({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new n.rP({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return L.schema()}}toJSON(){const e={type:this.type,value:""};if("string"==typeof this.value)e.value=this.value;else try{e.value=this.value.toJSON()}catch(e){}return e}}class U{constructor(e={}){this.altNames=(0,i.H$)(e,"altNames",U.defaultValues("altNames")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("altNames"===e)return[];throw new Error(`Invalid member name for AltName class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ZD({name:t.altNames||"",value:L.schema()})]})}fromSchema(e){(0,i.ze)(e,["altNames"]);const t=n.eN(e,e,U.schema({names:{altNames:"altNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AltName");"altNames"in t.result&&(this.altNames=Array.from(t.result.altNames,(e=>new L({schema:e}))))}toSchema(){return new n.T9({value:Array.from(this.altNames,(e=>e.toSchema()))})}toJSON(){return{altNames:Array.from(this.altNames,(e=>e.toJSON()))}}}class O{constructor(e={}){this.cA=(0,i.H$)(e,"cA",!1),"pathLenConstraint"in e&&(this.pathLenConstraint=(0,i.H$)(e,"pathLenConstraint",0)),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("cA"===e)return!1;throw new Error(`Invalid member name for BasicConstraints class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ge({optional:!0,name:t.cA||""}),new n.z8({optional:!0,name:t.pathLenConstraint||""})]})}fromSchema(e){(0,i.ze)(e,["cA","pathLenConstraint"]);const t=n.eN(e,e,O.schema({names:{cA:"cA",pathLenConstraint:"pathLenConstraint"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for BasicConstraints");"cA"in t.result&&(this.cA=t.result.cA.valueBlock.value),"pathLenConstraint"in t.result&&(t.result.pathLenConstraint.valueBlock.isHexOnly?this.pathLenConstraint=t.result.pathLenConstraint:this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==O.defaultValues("cA")&&e.push(new n.ge({value:this.cA})),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof n.z8?e.push(this.pathLenConstraint):e.push(new n.z8({value:this.pathLenConstraint}))),new n.T9({value:e})}toJSON(){const e={};return this.cA!==O.defaultValues("cA")&&(e.cA=this.cA),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof n.z8?e.pathLenConstraint=this.pathLenConstraint.toJSON():e.pathLenConstraint=this.pathLenConstraint),e}}class D{constructor(e={}){"distributionPoint"in e&&(this.distributionPoint=(0,i.H$)(e,"distributionPoint",D.defaultValues("distributionPoint"))),this.onlyContainsUserCerts=(0,i.H$)(e,"onlyContainsUserCerts",D.defaultValues("onlyContainsUserCerts")),this.onlyContainsCACerts=(0,i.H$)(e,"onlyContainsCACerts",D.defaultValues("onlyContainsCACerts")),"onlySomeReasons"in e&&(this.onlySomeReasons=(0,i.H$)(e,"onlySomeReasons",D.defaultValues("onlySomeReasons"))),this.indirectCRL=(0,i.H$)(e,"indirectCRL",D.defaultValues("indirectCRL")),this.onlyContainsAttributeCerts=(0,i.H$)(e,"onlyContainsAttributeCerts",D.defaultValues("onlyContainsAttributeCerts")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoint":return[];case"onlyContainsUserCerts":case"onlyContainsCACerts":case"indirectCRL":case"onlyContainsAttributeCerts":return!1;case"onlySomeReasons":return 0;default:throw new Error(`Invalid member name for IssuingDistributionPoint class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.Lv({value:[new n.FC({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:0},value:[new n.ZD({name:t.distributionPointNames||"",value:L.schema()})]}),new n.FC({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:1},value:E.schema().valueBlock.value})]})]}),new n.WV({name:t.onlyContainsUserCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new n.WV({name:t.onlyContainsCACerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new n.WV({name:t.onlySomeReasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new n.WV({name:t.indirectCRL||"",optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new n.WV({name:t.onlyContainsAttributeCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){(0,i.ze)(e,["distributionPoint","distributionPointNames","onlyContainsUserCerts","onlyContainsCACerts","onlySomeReasons","indirectCRL","onlyContainsAttributeCerts"]);const t=n.eN(e,e,D.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",onlyContainsUserCerts:"onlyContainsUserCerts",onlyContainsCACerts:"onlyContainsCACerts",onlySomeReasons:"onlySomeReasons",indirectCRL:"indirectCRL",onlyContainsAttributeCerts:"onlyContainsAttributeCerts"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for IssuingDistributionPoint");if("distributionPoint"in t.result)switch(!0){case 0===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=Array.from(t.result.distributionPointNames,(e=>new L({schema:e})));break;case 1===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=new E({schema:new n.T9({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if("onlyContainsUserCerts"in t.result){const e=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=0!==e[0]}if("onlyContainsCACerts"in t.result){const e=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=0!==e[0]}if("onlySomeReasons"in t.result){const e=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=e[0]}if("indirectCRL"in t.result){const e=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=0!==e[0]}if("onlyContainsAttributeCerts"in t.result){const e=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=0!==e[0]}}toSchema(){const e=[];if("distributionPoint"in this){let t;this.distributionPoint instanceof Array?t=new n.FC({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,(e=>e.toSchema()))}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new n.FC({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==D.defaultValues("onlyContainsUserCerts")&&e.push(new n.WV({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==D.defaultValues("onlyContainsCACerts")&&e.push(new n.WV({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),"onlySomeReasons"in this){const t=new ArrayBuffer(1);new Uint8Array(t)[0]=this.onlySomeReasons,e.push(new n.WV({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==D.defaultValues("indirectCRL")&&e.push(new n.WV({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==D.defaultValues("onlyContainsAttributeCerts")&&e.push(new n.WV({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new n.T9({value:e})}toJSON(){const e={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,(e=>e.toJSON())):e.distributionPoint=this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==D.defaultValues("onlyContainsUserCerts")&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==D.defaultValues("onlyContainsCACerts")&&(e.onlyContainsCACerts=this.onlyContainsCACerts),"onlySomeReasons"in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==D.defaultValues("indirectCRL")&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==D.defaultValues("onlyContainsAttributeCerts")&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}class T{constructor(e={}){this.names=(0,i.H$)(e,"names",T.defaultValues("names")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("names"===e)return[];throw new Error(`Invalid member name for GeneralNames class: ${e}`)}static schema(e={},t=!1){const r=(0,i.H$)(e,"names",{});return new n.T9({optional:t,name:r.blockName||"",value:[new n.ZD({name:r.generalNames||"",value:L.schema()})]})}fromSchema(e){(0,i.ze)(e,["names","generalNames"]);const t=n.eN(e,e,T.schema({names:{blockName:"names",generalNames:"generalNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralNames");this.names=Array.from(t.result.generalNames,(e=>new L({schema:e})))}toSchema(){return new n.T9({value:Array.from(this.names,(e=>e.toSchema()))})}toJSON(){return{names:Array.from(this.names,(e=>e.toJSON()))}}}class ${constructor(e={}){this.base=(0,i.H$)(e,"base",$.defaultValues("base")),this.minimum=(0,i.H$)(e,"minimum",$.defaultValues("minimum")),"maximum"in e&&(this.maximum=(0,i.H$)(e,"maximum",$.defaultValues("maximum"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"base":return new L;case"minimum":case"maximum":return 0;default:throw new Error(`Invalid member name for GeneralSubtree class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[L.schema(t.base||{}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.z8({name:t.minimum||""})]}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new n.z8({name:t.maximum||""})]})]})}fromSchema(e){(0,i.ze)(e,["base","minimum","maximum"]);const t=n.eN(e,e,$.schema({names:{base:{names:{blockName:"base"}},minimum:"minimum",maximum:"maximum"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralSubtree");this.base=new L({schema:t.result.base}),"minimum"in t.result&&(t.result.minimum.valueBlock.isHexOnly?this.minimum=t.result.minimum:this.minimum=t.result.minimum.valueBlock.valueDec),"maximum"in t.result&&(t.result.maximum.valueBlock.isHexOnly?this.maximum=t.result.maximum:this.maximum=t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),0!==this.minimum){let t=0;t=this.minimum instanceof n.z8?this.minimum:new n.z8({value:this.minimum}),e.push(new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if("maximum"in this){let t=0;t=this.maximum instanceof n.z8?this.maximum:new n.z8({value:this.maximum}),e.push(new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new n.T9({value:e})}toJSON(){const e={base:this.base.toJSON()};return 0!==this.minimum&&("number"==typeof this.minimum?e.minimum=this.minimum:e.minimum=this.minimum.toJSON()),"maximum"in this&&("number"==typeof this.maximum?e.maximum=this.maximum:e.maximum=this.maximum.toJSON()),e}}class R{constructor(e={}){"permittedSubtrees"in e&&(this.permittedSubtrees=(0,i.H$)(e,"permittedSubtrees",R.defaultValues("permittedSubtrees"))),"excludedSubtrees"in e&&(this.excludedSubtrees=(0,i.H$)(e,"excludedSubtrees",R.defaultValues("excludedSubtrees"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"permittedSubtrees":case"excludedSubtrees":return[];default:throw new Error(`Invalid member name for NameConstraints class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.ZD({name:t.permittedSubtrees||"",value:$.schema()})]}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new n.ZD({name:t.excludedSubtrees||"",value:$.schema()})]})]})}fromSchema(e){(0,i.ze)(e,["permittedSubtrees","excludedSubtrees"]);const t=n.eN(e,e,R.schema({names:{permittedSubtrees:"permittedSubtrees",excludedSubtrees:"excludedSubtrees"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for NameConstraints");"permittedSubtrees"in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,(e=>new $({schema:e})))),"excludedSubtrees"in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,(e=>new $({schema:e}))))}toSchema(){const e=[];return"permittedSubtrees"in this&&e.push(new n.FC({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,(e=>e.toSchema()))})),"excludedSubtrees"in this&&e.push(new n.FC({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,(e=>e.toSchema()))})),new n.T9({value:e})}toJSON(){const e={};return"permittedSubtrees"in this&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,(e=>e.toJSON()))),"excludedSubtrees"in this&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,(e=>e.toJSON()))),e}}class j{constructor(e={}){"distributionPoint"in e&&(this.distributionPoint=(0,i.H$)(e,"distributionPoint",j.defaultValues("distributionPoint"))),"reasons"in e&&(this.reasons=(0,i.H$)(e,"reasons",j.defaultValues("reasons"))),"cRLIssuer"in e&&(this.cRLIssuer=(0,i.H$)(e,"cRLIssuer",j.defaultValues("cRLIssuer"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoint":case"cRLIssuer":return[];case"reasons":return new n._K;default:throw new Error(`Invalid member name for DistributionPoint class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.Lv({value:[new n.FC({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.ZD({name:t.distributionPointNames||"",value:L.schema()})]}),new n.FC({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:1},value:E.schema().valueBlock.value})]})]}),new n.WV({name:t.reasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new n.FC({name:t.cRLIssuer||"",optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new n.ZD({name:t.cRLIssuerNames||"",value:L.schema()})]})]})}fromSchema(e){(0,i.ze)(e,["distributionPoint","distributionPointNames","reasons","cRLIssuer","cRLIssuerNames"]);const t=n.eN(e,e,j.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",reasons:"reasons",cRLIssuer:"cRLIssuer",cRLIssuerNames:"cRLIssuerNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for DistributionPoint");"distributionPoint"in t.result&&(0===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=Array.from(t.result.distributionPointNames,(e=>new L({schema:e})))),1===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=new E({schema:new n.T9({value:t.result.distributionPoint.valueBlock.value})}))),"reasons"in t.result&&(this.reasons=new n._K({valueHex:t.result.reasons.valueBlock.valueHex})),"cRLIssuer"in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,(e=>new L({schema:e}))))}toSchema(){const e=[];if("distributionPoint"in this){let t;t=this.distributionPoint instanceof Array?new n.FC({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,(e=>e.toSchema()))}):new n.FC({idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new n.FC({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return"reasons"in this&&e.push(new n.WV({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHex})),"cRLIssuer"in this&&e.push(new n.FC({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,(e=>e.toSchema()))})),new n.T9({value:e})}toJSON(){const e={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,(e=>e.toJSON())):e.distributionPoint=this.distributionPoint.toJSON()),"reasons"in this&&(e.reasons=this.reasons.toJSON()),"cRLIssuer"in this&&(e.cRLIssuer=Array.from(this.cRLIssuer,(e=>e.toJSON()))),e}}class _{constructor(e={}){this.distributionPoints=(0,i.H$)(e,"distributionPoints",_.defaultValues("distributionPoints")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("distributionPoints"===e)return[];throw new Error(`Invalid member name for CRLDistributionPoints class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ZD({name:t.distributionPoints||"",value:j.schema()})]})}fromSchema(e){(0,i.ze)(e,["distributionPoints"]);const t=n.eN(e,e,_.schema({names:{distributionPoints:"distributionPoints"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CRLDistributionPoints");this.distributionPoints=Array.from(t.result.distributionPoints,(e=>new j({schema:e})))}toSchema(){return new n.T9({value:Array.from(this.distributionPoints,(e=>e.toSchema()))})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,(e=>e.toJSON()))}}}class K{constructor(e={}){this.policyQualifierId=(0,i.H$)(e,"policyQualifierId",K.defaultValues("policyQualifierId")),this.qualifier=(0,i.H$)(e,"qualifier",K.defaultValues("qualifier")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"policyQualifierId":return"";case"qualifier":return new n.IK;default:throw new Error(`Invalid member name for PolicyQualifierInfo class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.policyQualifierId||""}),new n.IK({name:t.qualifier||""})]})}fromSchema(e){(0,i.ze)(e,["policyQualifierId","qualifier"]);const t=n.eN(e,e,K.schema({names:{policyQualifierId:"policyQualifierId",qualifier:"qualifier"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyQualifierInfo");this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new n.T9({value:[new n.rP({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}class F{constructor(e={}){this.policyIdentifier=(0,i.H$)(e,"policyIdentifier",F.defaultValues("policyIdentifier")),"policyQualifiers"in e&&(this.policyQualifiers=(0,i.H$)(e,"policyQualifiers",F.defaultValues("policyQualifiers"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"policyIdentifier":return"";case"policyQualifiers":return[];default:throw new Error(`Invalid member name for PolicyInformation class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.policyIdentifier||""}),new n.T9({optional:!0,value:[new n.ZD({name:t.policyQualifiers||"",value:K.schema()})]})]})}fromSchema(e){(0,i.ze)(e,["policyIdentifier","policyQualifiers"]);const t=n.eN(e,e,F.schema({names:{policyIdentifier:"policyIdentifier",policyQualifiers:"policyQualifiers"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyInformation");this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),"policyQualifiers"in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,(e=>new K({schema:e}))))}toSchema(){const e=[];return e.push(new n.rP({value:this.policyIdentifier})),"policyQualifiers"in this&&e.push(new n.T9({value:Array.from(this.policyQualifiers,(e=>e.toSchema()))})),new n.T9({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return"policyQualifiers"in this&&(e.policyQualifiers=Array.from(this.policyQualifiers,(e=>e.toJSON()))),e}}class M{constructor(e={}){this.certificatePolicies=(0,i.H$)(e,"certificatePolicies",M.defaultValues("certificatePolicies")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("certificatePolicies"===e)return[];throw new Error(`Invalid member name for CertificatePolicies class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ZD({name:t.certificatePolicies||"",value:F.schema()})]})}fromSchema(e){(0,i.ze)(e,["certificatePolicies"]);const t=n.eN(e,e,M.schema({names:{certificatePolicies:"certificatePolicies"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificatePolicies");this.certificatePolicies=Array.from(t.result.certificatePolicies,(e=>new F({schema:e})))}toSchema(){return new n.T9({value:Array.from(this.certificatePolicies,(e=>e.toSchema()))})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,(e=>e.toJSON()))}}}class J{constructor(e={}){this.issuerDomainPolicy=(0,i.H$)(e,"issuerDomainPolicy",J.defaultValues("issuerDomainPolicy")),this.subjectDomainPolicy=(0,i.H$)(e,"subjectDomainPolicy",J.defaultValues("subjectDomainPolicy")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"issuerDomainPolicy":case"subjectDomainPolicy":return"";default:throw new Error(`Invalid member name for PolicyMapping class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.issuerDomainPolicy||""}),new n.rP({name:t.subjectDomainPolicy||""})]})}fromSchema(e){(0,i.ze)(e,["issuerDomainPolicy","subjectDomainPolicy"]);const t=n.eN(e,e,J.schema({names:{issuerDomainPolicy:"issuerDomainPolicy",subjectDomainPolicy:"subjectDomainPolicy"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyMapping");this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new n.T9({value:[new n.rP({value:this.issuerDomainPolicy}),new n.rP({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}class z{constructor(e={}){this.mappings=(0,i.H$)(e,"mappings",z.defaultValues("mappings")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("mappings"===e)return[];throw new Error(`Invalid member name for PolicyMappings class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ZD({name:t.mappings||"",value:J.schema()})]})}fromSchema(e){(0,i.ze)(e,["mappings"]);const t=n.eN(e,e,z.schema({names:{mappings:"mappings"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyMappings");this.mappings=Array.from(t.result.mappings,(e=>new J({schema:e})))}toSchema(){return new n.T9({value:Array.from(this.mappings,(e=>e.toSchema()))})}toJSON(){return{mappings:Array.from(this.mappings,(e=>e.toJSON()))}}}class G{constructor(e={}){"keyIdentifier"in e&&(this.keyIdentifier=(0,i.H$)(e,"keyIdentifier",G.defaultValues("keyIdentifier"))),"authorityCertIssuer"in e&&(this.authorityCertIssuer=(0,i.H$)(e,"authorityCertIssuer",G.defaultValues("authorityCertIssuer"))),"authorityCertSerialNumber"in e&&(this.authorityCertSerialNumber=(0,i.H$)(e,"authorityCertSerialNumber",G.defaultValues("authorityCertSerialNumber"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyIdentifier":return new n.fi;case"authorityCertIssuer":return[];case"authorityCertSerialNumber":return new n.z8;default:throw new Error(`Invalid member name for AuthorityKeyIdentifier class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.WV({name:t.keyIdentifier||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new n.ZD({name:t.authorityCertIssuer||"",value:L.schema()})]}),new n.WV({name:t.authorityCertSerialNumber||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){(0,i.ze)(e,["keyIdentifier","authorityCertIssuer","authorityCertSerialNumber"]);const t=n.eN(e,e,G.schema({names:{keyIdentifier:"keyIdentifier",authorityCertIssuer:"authorityCertIssuer",authorityCertSerialNumber:"authorityCertSerialNumber"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AuthorityKeyIdentifier");"keyIdentifier"in t.result&&(this.keyIdentifier=new n.fi({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),"authorityCertIssuer"in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,(e=>new L({schema:e})))),"authorityCertSerialNumber"in t.result&&(this.authorityCertSerialNumber=new n.z8({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return"keyIdentifier"in this&&e.push(new n.WV({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHex})),"authorityCertIssuer"in this&&e.push(new n.FC({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,(e=>e.toSchema()))})),"authorityCertSerialNumber"in this&&e.push(new n.WV({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHex})),new n.T9({value:e})}toJSON(){const e={};return"keyIdentifier"in this&&(e.keyIdentifier=this.keyIdentifier.toJSON()),"authorityCertIssuer"in this&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,(e=>e.toJSON()))),"authorityCertSerialNumber"in this&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}class q{constructor(e={}){"requireExplicitPolicy"in e&&(this.requireExplicitPolicy=(0,i.H$)(e,"requireExplicitPolicy",q.defaultValues("requireExplicitPolicy"))),"inhibitPolicyMapping"in e&&(this.inhibitPolicyMapping=(0,i.H$)(e,"inhibitPolicyMapping",q.defaultValues("inhibitPolicyMapping"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"requireExplicitPolicy":case"inhibitPolicyMapping":return 0;default:throw new Error(`Invalid member name for PolicyConstraints class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.WV({name:t.requireExplicitPolicy||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new n.WV({name:t.inhibitPolicyMapping||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){(0,i.ze)(e,["requireExplicitPolicy","inhibitPolicyMapping"]);const t=n.eN(e,e,q.schema({names:{requireExplicitPolicy:"requireExplicitPolicy",inhibitPolicyMapping:"inhibitPolicyMapping"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyConstraints");if("requireExplicitPolicy"in t.result){const e=t.result.requireExplicitPolicy;e.idBlock.tagClass=1,e.idBlock.tagNumber=2;const r=e.toBER(!1),i=n.sc(r);this.requireExplicitPolicy=i.result.valueBlock.valueDec}if("inhibitPolicyMapping"in t.result){const e=t.result.inhibitPolicyMapping;e.idBlock.tagClass=1,e.idBlock.tagNumber=2;const r=e.toBER(!1),i=n.sc(r);this.inhibitPolicyMapping=i.result.valueBlock.valueDec}}toSchema(){const e=[];if("requireExplicitPolicy"in this){const t=new n.z8({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if("inhibitPolicyMapping"in this){const t=new n.z8({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new n.T9({value:e})}toJSON(){const e={};return"requireExplicitPolicy"in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),"inhibitPolicyMapping"in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}class W{constructor(e={}){this.keyPurposes=(0,i.H$)(e,"keyPurposes",W.defaultValues("keyPurposes")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("keyPurposes"===e)return[];throw new Error(`Invalid member name for ExtKeyUsage class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ZD({name:t.keyPurposes||"",value:new n.rP})]})}fromSchema(e){(0,i.ze)(e,["keyPurposes"]);const t=n.eN(e,e,W.schema({names:{keyPurposes:"keyPurposes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ExtKeyUsage");this.keyPurposes=Array.from(t.result.keyPurposes,(e=>e.valueBlock.toString()))}toSchema(){return new n.T9({value:Array.from(this.keyPurposes,(e=>new n.rP({value:e})))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}class Z{constructor(e={}){this.accessMethod=(0,i.H$)(e,"accessMethod",Z.defaultValues("accessMethod")),this.accessLocation=(0,i.H$)(e,"accessLocation",Z.defaultValues("accessLocation")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"accessMethod":return"";case"accessLocation":return new L;default:throw new Error(`Invalid member name for AccessDescription class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.accessMethod||""}),L.schema(t.accessLocation||{})]})}fromSchema(e){(0,i.ze)(e,["accessMethod","accessLocation"]);const t=n.eN(e,e,Z.schema({names:{accessMethod:"accessMethod",accessLocation:{names:{blockName:"accessLocation"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AccessDescription");this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new L({schema:t.result.accessLocation})}toSchema(){return new n.T9({value:[new n.rP({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}class Q{constructor(e={}){this.accessDescriptions=(0,i.H$)(e,"accessDescriptions",Q.defaultValues("accessDescriptions")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("accessDescriptions"===e)return[];throw new Error(`Invalid member name for InfoAccess class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ZD({name:t.accessDescriptions||"",value:Z.schema()})]})}fromSchema(e){(0,i.ze)(e,["accessDescriptions"]);const t=n.eN(e,e,Q.schema({names:{accessDescriptions:"accessDescriptions"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for InfoAccess");this.accessDescriptions=Array.from(t.result.accessDescriptions,(e=>new Z({schema:e})))}toSchema(){return new n.T9({value:Array.from(this.accessDescriptions,(e=>e.toSchema()))})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,(e=>e.toJSON()))}}}class Y{constructor(e={}){this.clear();for(const t of Object.keys(e))switch(t){case"length":this.length=e.length;break;case"stub":for(let t=0;t<this._view.length;t++)this._view[t]=e.stub;break;case"view":this.fromUint8Array(e.view);break;case"buffer":this.fromArrayBuffer(e.buffer);break;case"string":this.fromString(e.string);break;case"hexstring":this.fromHexString(e.hexstring)}}set buffer(e){this._buffer=e.slice(0),this._view=new Uint8Array(this._buffer)}get buffer(){return this._buffer}set view(e){this._buffer=new ArrayBuffer(e.length),this._view=new Uint8Array(this._buffer),this._view.set(e)}get view(){return this._view}get length(){return this._buffer.byteLength}set length(e){this._buffer=new ArrayBuffer(e),this._view=new Uint8Array(this._buffer)}clear(){this._buffer=new ArrayBuffer(0),this._view=new Uint8Array(this._buffer)}fromArrayBuffer(e){this.buffer=e}fromUint8Array(e){this._buffer=new ArrayBuffer(e.length),this._view=new Uint8Array(this._buffer),this._view.set(e)}fromString(e){const t=e.length;this.length=t;for(let r=0;r<t;r++)this.view[r]=e.charCodeAt(r)}toString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let n=e;n<e+t;n++)r+=String.fromCharCode(this.view[n]);return r}fromHexString(e){const t=e.length;this.buffer=new ArrayBuffer(t>>1),this.view=new Uint8Array(this.buffer);const r=new Map;r.set("0",0),r.set("1",1),r.set("2",2),r.set("3",3),r.set("4",4),r.set("5",5),r.set("6",6),r.set("7",7),r.set("8",8),r.set("9",9),r.set("A",10),r.set("a",10),r.set("B",11),r.set("b",11),r.set("C",12),r.set("c",12),r.set("D",13),r.set("d",13),r.set("E",14),r.set("e",14),r.set("F",15),r.set("f",15);let n=0,i=0;for(let s=0;s<t;s++)s%2?(i|=r.get(e.charAt(s)),this.view[n]=i,n++):i=r.get(e.charAt(s))<<4}toHexString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let n=e;n<e+t;n++){const e=this.view[n].toString(16).toUpperCase();r=r+(1==e.length?"0":"")+e}return r}copy(e=0,t=this._buffer.byteLength-e){if(0===e&&0===this._buffer.byteLength)return new Y;if(e<0||e>this._buffer.byteLength-1)throw new Error(`Wrong start position: ${e}`);const r=new Y;return r._buffer=this._buffer.slice(e,e+t),r._view=new Uint8Array(r._buffer),r}slice(e=0,t=this._buffer.byteLength){if(0===e&&0===this._buffer.byteLength)return new Y;if(e<0||e>this._buffer.byteLength-1)throw new Error(`Wrong start position: ${e}`);const r=new Y;return r._buffer=this._buffer.slice(e,t),r._view=new Uint8Array(r._buffer),r}realloc(e){const t=new ArrayBuffer(e),r=new Uint8Array(t);e>this._view.length?r.set(this._view):r.set(new Uint8Array(this._buffer,0,e)),this._buffer=t.slice(0),this._view=new Uint8Array(this._buffer)}append(e){const t=this._buffer.byteLength,r=e._buffer.byteLength,n=e._view.slice();this.realloc(t+r),this._view.set(n,t)}insert(e,t=0,r=this._buffer.byteLength-t){return!(t>this._buffer.byteLength-1)&&(r>this._buffer.byteLength-t&&(r=this._buffer.byteLength-t),r>e._buffer.byteLength&&(r=e._buffer.byteLength),r==e._buffer.byteLength?this._view.set(e._view,t):this._view.set(e._view.slice(0,r),t),!0)}isEqual(e){if(this._buffer.byteLength!=e._buffer.byteLength)return!1;for(let t=0;t<e._buffer.byteLength;t++)if(this.view[t]!=e.view[t])return!1;return!0}isEqualView(e){if(e.length!=this.view.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e[t])return!1;return!0}findPattern(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));const i=e.buffer.byteLength;if(i>r)return-1;const s=[];for(let t=0;t<i;t++)s.push(e.view[t]);for(let e=0;e<=r-i;e++){let r=!0;const a=n?t-i-e:t+e;for(let e=0;e<i;e++)if(this.view[e+a]!=s[e]){r=!1;break}if(r)return n?t-i-e:t+i+e}return-1}findFirstIn(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));const i={id:-1,position:n?0:t+r,length:0};for(let s=0;s<e.length;s++){const a=this.findPattern(e[s],t,r,n);if(-1!=a){let t=!1;const r=e[s].length;n?a-r>=i.position-i.length&&(t=!0):a-r<=i.position-i.length&&(t=!0),t&&(i.position=a,i.id=s,i.length=r)}}return i}findAllIn(e,t=0,r=this.buffer.byteLength-t){const n=[];if(null==t&&(t=0),t>this.buffer.byteLength-1)return n;null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t);let i={id:-1,position:t};for(;;){const t=i.position;if(i=this.findFirstIn(e,i.position,r),-1==i.id)break;r-=i.position-t,n.push({id:i.id,position:i.position})}return n}findAllPatternIn(e,t=0,r=this.buffer.byteLength-t){null==t&&(t=0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t);const n=[],i=e.buffer.byteLength;if(i>r)return-1;const s=Array.from(e.view);for(let e=0;e<=r-i;e++){let r=!0;const a=t+e;for(let e=0;e<i;e++)if(this.view[e+a]!=s[e]){r=!1;break}r&&(n.push(t+i+e),e+=i-1)}return n}findFirstNotIn(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));const i={left:{id:-1,position:t},right:{id:-1,position:0},value:new Y};let s=r;for(;s>0;){if(i.right=this.findFirstIn(e,n?t-r+s:t+r-s,s,n),-1==i.right.id){r=s,n?t-=r:t=i.left.position,i.value=new Y,i.value._buffer=this._buffer.slice(t,t+r),i.value._view=new Uint8Array(i.value._buffer);break}if(i.right.position!=(n?i.left.position-e[i.right.id].buffer.byteLength:i.left.position+e[i.right.id].buffer.byteLength)){n?(t=i.right.position+e[i.right.id].buffer.byteLength,r=i.left.position-i.right.position-e[i.right.id].buffer.byteLength):(t=i.left.position,r=i.right.position-i.left.position-e[i.right.id].buffer.byteLength),i.value=new Y,i.value._buffer=this._buffer.slice(t,t+r),i.value._view=new Uint8Array(i.value._buffer);break}i.left=i.right,s-=e[i.right.id]._buffer.byteLength}if(n){const e=i.right;i.right=i.left,i.left=e}return i}findAllNotIn(e,t=null,r=null){const n=[];if(null==t&&(t=0),t>this.buffer.byteLength-1)return n;null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t);let i={left:{id:-1,position:t},right:{id:-1,position:t},value:new Y};do{const t=i.right.position;i=this.findFirstNotIn(e,i.right.position,r),r-=i.right.position-t,n.push({left:{id:i.left.id,position:i.left.position},right:{id:i.right.id,position:i.right.position},value:i.value})}while(-1!=i.right.id);return n}findFirstSequence(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));const i=this.skipNotPatterns(e,t,r,n);if(-1==i)return{position:-1,value:new Y};const s=this.skipPatterns(e,i,r-(n?t-i:i-t),n);n?(t=s,r=i-s):(t=i,r=s-i);const a=new Y;return a._buffer=this._buffer.slice(t,t+r),a._view=new Uint8Array(a._buffer),{position:s,value:a}}findAllSequences(e,t=null,r=null){const n=[];if(null==t&&(t=0),t>this.buffer.byteLength-1)return n;null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t);let i={position:t,value:new Y};do{const t=i.position;i=this.findFirstSequence(e,i.position,r),-1!=i.position&&(r-=i.position-t,n.push({position:i.position,value:i.value}))}while(-1!=i.position);return n}findPairedPatterns(e,t,r=null,n=null){const i=[];if(e.isEqual(t))return i;if(null==r&&(r=0),r>this.buffer.byteLength-1)return i;null==n&&(n=this.buffer.byteLength-r),n>this.buffer.byteLength-r&&(n=this.buffer.byteLength-r);let s=0;const a=this.findAllPatternIn(e,r,n);if(0==a.length)return i;const o=this.findAllPatternIn(t,r,n);if(0==o.length)return i;for(;s<a.length&&0!=o.length;)if(a[0]!=o[0]){if(a[s]>o[0])break;for(;a[s]<o[0]&&(s++,!(s>=a.length)););i.push({left:a[s-1],right:o[0]}),a.splice(s-1,1),o.splice(0,1),s=0}else i.push({left:a[0],right:o[0]}),a.splice(0,1),o.splice(0,1);return i.sort(((e,t)=>e.left-t.left)),i}findPairedArrays(e,t,r=null,n=null){const i=[];if(null==r&&(r=0),r>this.buffer.byteLength-1)return i;null==n&&(n=this.buffer.byteLength-r),n>this.buffer.byteLength-r&&(n=this.buffer.byteLength-r);let s=0;const a=this.findAllIn(e,r,n);if(0==a.length)return i;const o=this.findAllIn(t,r,n);if(0==o.length)return i;for(;s<a.length&&0!=o.length;)if(a[0].position!=o[0].position){if(a[s].position>o[0].position)break;for(;a[s].position<o[0].position&&(s++,!(s>=a.length)););i.push({left:a[s-1],right:o[0]}),a.splice(s-1,1),o.splice(0,1),s=0}else i.push({left:a[0],right:o[0]}),a.splice(0,1),o.splice(0,1);return i.sort(((e,t)=>e.left.position-t.left.position)),i}replacePattern(e,t,r=null,n=null,i=null){let s,a;const o={status:-1,searchPatternPositions:[],replacePatternPositions:[]};if(null==r&&(r=0),r>this.buffer.byteLength-1)return!1;if(null==n&&(n=this.buffer.byteLength-r),n>this.buffer.byteLength-r&&(n=this.buffer.byteLength-r),null==i){if(s=this.findAllIn([e],r,n),0==s.length)return o}else s=i;o.searchPatternPositions.push(...Array.from(s,(e=>e.position)));const l=e.buffer.byteLength-t.buffer.byteLength,u=new ArrayBuffer(this.view.length-s.length*l),c=new Uint8Array(u);for(c.set(new Uint8Array(this.buffer,0,r)),a=0;a<s.length;a++){const n=0==a?r:s[a-1].position;c.set(new Uint8Array(this.buffer,n,s[a].position-e.buffer.byteLength-n),n-a*l),c.set(t.view,s[a].position-e.buffer.byteLength-a*l),o.replacePatternPositions.push(s[a].position-e.buffer.byteLength-a*l)}return a--,c.set(new Uint8Array(this.buffer,s[a].position,this.buffer.byteLength-s[a].position),s[a].position-e.buffer.byteLength+t.buffer.byteLength-a*l),this.buffer=u,this.view=new Uint8Array(this.buffer),o.status=1,o}skipPatterns(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));let i=t;for(let s=0;s<e.length;s++){const a=e[s].buffer.byteLength,o=n?i-a:i;let l=!0;for(let t=0;t<a;t++)if(this.view[t+o]!=e[s].view[t]){l=!1;break}if(l)if(s=-1,n){if(i-=a,i<=0)return i}else if(i+=a,i>=t+r)return i}return i}skipNotPatterns(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));let i=-1;for(let s=0;s<r;s++){for(let r=0;r<e.length;r++){const a=e[r].buffer.byteLength,o=n?t-s-a:t+s;let l=!0;for(let t=0;t<a;t++)if(this.view[t+o]!=e[r].view[t]){l=!1;break}if(l){i=n?t-s:t+s;break}}if(-1!=i)break}return i}}class X{constructor(e={}){this.stream=new Y,this._length=0,this.backward=!1,this._start=0,this.appendBlock=0,this.prevLength=0,this.prevStart=0;for(const t of Object.keys(e))switch(t){case"stream":this.stream=e.stream;break;case"backward":this.backward=e.backward,this._start=this.stream.buffer.byteLength;break;case"length":this._length=e.length;break;case"start":this._start=e.start;break;case"appendBlock":this.appendBlock=e.appendBlock;break;case"view":this.stream=new Y({view:e.view});break;case"buffer":this.stream=new Y({buffer:e.buffer});break;case"string":this.stream=new Y({string:e.string});break;case"hexstring":this.stream=new Y({hexstring:e.hexstring})}}set stream(e){this._stream=e,this.prevLength=this._length,this._length=e._buffer.byteLength,this.prevStart=this._start,this._start=0}get stream(){return this._stream}set length(e){this.prevLength=this._length,this._length=e}get length(){return this.appendBlock?this.start:this._length}set start(e){e>this.stream.buffer.byteLength||(this.prevStart=this._start,this.prevLength=this._length,this._length-=this.backward?this._start-e:e-this._start,this._start=e)}get start(){return this._start}get buffer(){return this._stream._buffer.slice(0,this._length)}resetPosition(){this._start=this.prevStart,this._length=this.prevLength}findPattern(e,t=null){(null==t||t>this.length)&&(t=this.length);const r=this.stream.findPattern(e,this.start,this.length,this.backward);if(-1==r)return r;if(this.backward){if(r<this.start-e.buffer.byteLength-t)return-1}else if(r>this.start+e.buffer.byteLength+t)return-1;return this.start=r,r}findFirstIn(e,t=null){(null==t||t>this.length)&&(t=this.length);const r=this.stream.findFirstIn(e,this.start,this.length,this.backward);if(-1==r.id)return r;if(this.backward){if(r.position<this.start-e[r.id].buffer.byteLength-t)return{id:-1,position:this.backward?0:this.start+this.length}}else if(r.position>this.start+e[r.id].buffer.byteLength+t)return{id:-1,position:this.backward?0:this.start+this.length};return this.start=r.position,r}findAllIn(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllIn(e,t,this.length)}findFirstNotIn(e,t=null){(null==t||t>this._length)&&(t=this._length);const r=this._stream.findFirstNotIn(e,this._start,this._length,this.backward);if(-1==r.left.id&&-1==r.right.id)return r;if(this.backward){if(-1!=r.right.id&&r.right.position<this._start-e[r.right.id]._buffer.byteLength-t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new Y}}else if(-1!=r.left.id&&r.left.position>this._start+e[r.left.id]._buffer.byteLength+t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new Y};return this.backward?-1==r.left.id?this.start=0:this.start=r.left.position:-1==r.right.id?this.start=this._start+this._length:this.start=r.right.position,r}findAllNotIn(e){const t=this.backward?this._start-this._length:this._start;return this._stream.findAllNotIn(e,t,this._length)}findFirstSequence(e,t=null,r=null){(null==t||t>this._length)&&(t=this._length),(null==r||r>t)&&(r=t);const n=this._stream.findFirstSequence(e,this._start,t,this.backward);if(0==n.value.buffer.byteLength)return n;if(this.backward){if(n.position<this._start-n.value._buffer.byteLength-r)return{position:-1,value:new Y}}else if(n.position>this._start+n.value._buffer.byteLength+r)return{position:-1,value:new Y};return this.start=n.position,n}findAllSequences(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllSequences(e,t,this.length)}findPairedPatterns(e,t,r=null){(null==r||r>this.length)&&(r=this.length);const n=this.backward?this.start-this.length:this.start,i=this.stream.findPairedPatterns(e,t,n,this.length);if(i.length)if(this.backward){if(i[0].right<this.start-t.buffer.byteLength-r)return[]}else if(i[0].left>this.start+e.buffer.byteLength+r)return[];return i}findPairedArrays(e,t,r=null){(null==r||r>this.length)&&(r=this.length);const n=this.backward?this.start-this.length:this.start,i=this.stream.findPairedArrays(e,t,n,this.length);if(i.length)if(this.backward){if(i[0].right.position<this.start-t[i[0].right.id].buffer.byteLength-r)return[]}else if(i[0].left.position>this.start+e[i[0].left.id].buffer.byteLength+r)return[];return i}replacePattern(e,t){const r=this.backward?this.start-this.length:this.start;return this.stream.replacePattern(e,t,r,this.length)}skipPatterns(e){const t=this.stream.skipPatterns(e,this.start,this.length,this.backward);return this.start=t,t}skipNotPatterns(e){const t=this.stream.skipNotPatterns(e,this.start,this.length,this.backward);return-1==t?-1:(this.start=t,t)}append(e){this._start+e._buffer.byteLength>this._stream._buffer.byteLength&&(e._buffer.byteLength>this.appendBlock&&(this.appendBlock=e._buffer.byteLength+1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock)),this._stream._view.set(e._view,this._start),this._length+=2*e._buffer.byteLength,this.start=this._start+e._buffer.byteLength,this.prevLength-=2*e._buffer.byteLength}appendView(e){this._start+e.length>this._stream._buffer.byteLength&&(e.length>this.appendBlock&&(this.appendBlock=e.length+1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock)),this._stream._view.set(e,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendChar(e){this._start+1>this._stream._buffer.byteLength&&(1>this.appendBlock&&(this.appendBlock=1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock)),this._stream._view[this._start]=e,this._length+=2,this.start=this._start+1,this.prevLength-=2}appendUint16(e){this._start+2>this._stream._buffer.byteLength&&(2>this.appendBlock&&(this.appendBlock=1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock));const t=new Uint16Array([e]),r=new Uint8Array(t.buffer);this._stream._view[this._start]=r[1],this._stream._view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendUint24(e){this._start+3>this._stream._buffer.byteLength&&(3>this.appendBlock&&(this.appendBlock=1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock));const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream._view[this._start]=r[2],this._stream._view[this._start+1]=r[1],this._stream._view[this._start+2]=r[0],this._length+=6,this.start=this._start+3,this.prevLength-=6}appendUint32(e){this._start+4>this._stream._buffer.byteLength&&(4>this.appendBlock&&(this.appendBlock=1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock));const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream._view[this._start]=r[3],this._stream._view[this._start+1]=r[2],this._stream._view[this._start+2]=r[1],this._stream._view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}getBlock(e,t=!0){if(this._length<=0)return[];let r;if(this._length<e&&(e=this._length),this.backward){const t=this._stream._buffer.slice(this._length-e,this._length),n=new Uint8Array(t);r=new Array(e);for(let t=0;t<e;t++)r[e-1-t]=n[t]}else{const t=this._stream._buffer.slice(this._start,this._start+e);r=Array.from(new Uint8Array(t))}return t&&(this.start+=this.backward?-1*e:e),r}getUint16(e=!0){const t=this.getBlock(2,e);if(t.length<2)return 0;const r=new Uint16Array(1),n=new Uint8Array(r.buffer);return n[0]=t[1],n[1]=t[0],r[0]}getInt16(e=!0){const t=this.getBlock(2,e);if(t.length<2)return 0;const r=new Int16Array(1),n=new Uint8Array(r.buffer);return n[0]=t[1],n[1]=t[0],r[0]}getUint24(e=!0){const t=this.getBlock(3,e);if(t.length<3)return 0;const r=new Uint32Array(1),n=new Uint8Array(r.buffer);for(let e=3;e>=1;e--)n[3-e]=t[e-1];return r[0]}getUint32(e=!0){const t=this.getBlock(4,e);if(t.length<4)return 0;const r=new Uint32Array(1),n=new Uint8Array(r.buffer);for(let e=3;e>=0;e--)n[3-e]=t[e];return r[0]}getInt32(e=!0){const t=this.getBlock(4,e);if(t.length<4)return 0;const r=new Int32Array(1),n=new Uint8Array(r.buffer);for(let e=3;e>=0;e--)n[3-e]=t[e];return r[0]}}class ee{constructor(e={}){this.version=(0,i.H$)(e,"version",ee.defaultValues("version")),this.logID=(0,i.H$)(e,"logID",ee.defaultValues("logID")),this.timestamp=(0,i.H$)(e,"timestamp",ee.defaultValues("timestamp")),this.extensions=(0,i.H$)(e,"extensions",ee.defaultValues("extensions")),this.hashAlgorithm=(0,i.H$)(e,"hashAlgorithm",ee.defaultValues("hashAlgorithm")),this.signatureAlgorithm=(0,i.H$)(e,"signatureAlgorithm",ee.defaultValues("signatureAlgorithm")),this.signature=(0,i.H$)(e,"signature",ee.defaultValues("signature")),"schema"in e&&this.fromSchema(e.schema),"stream"in e&&this.fromStream(e.stream)}static defaultValues(e){switch(e){case"version":return 0;case"logID":case"extensions":return new ArrayBuffer(0);case"timestamp":return new Date(0);case"hashAlgorithm":case"signatureAlgorithm":return"";case"signature":return new n.IK;default:throw new Error(`Invalid member name for SignedCertificateTimestamp class: ${e}`)}}fromSchema(e){if(e instanceof n.Gh==!1)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new X({stream:new Y({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],0===this.version){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date((0,i.r9)(new Uint8Array(e.getBlock(8)),8));const r=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(r)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm="none";break;case 1:this.hashAlgorithm="md5";break;case 2:this.hashAlgorithm="sha1";break;case 3:this.hashAlgorithm="sha224";break;case 4:this.hashAlgorithm="sha256";break;case 5:this.hashAlgorithm="sha384";break;case 6:this.hashAlgorithm="sha512";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm="anonymous";break;case 1:this.signatureAlgorithm="rsa";break;case 2:this.signatureAlgorithm="dsa";break;case 3:this.signatureAlgorithm="ecdsa";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const s=e.getUint16(),a=new Uint8Array(e.getBlock(s)).buffer.slice(0),o=n.sc(a);if(-1===o.offset)throw new Error("Object's stream was not correct for SignedCertificateTimestamp");if(this.signature=o.result,t!==47+r+s)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new n.Gh({data:e.stream.buffer})}toStream(){const e=new X;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecode.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),r=new Uint8Array(t),n=(0,i.lL)(this.timestamp.valueOf(),8);let s,a;switch(r.set(new Uint8Array(n),8-n.byteLength),e.appendView(r),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions)),this.hashAlgorithm.toLowerCase()){case"none":s=0;break;case"md5":s=1;break;case"sha1":s=2;break;case"sha224":s=3;break;case"sha256":s=4;break;case"sha384":s=5;break;case"sha512":s=6;break;default:throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`)}switch(e.appendChar(s),this.signatureAlgorithm.toLowerCase()){case"anonymous":a=0;break;case"rsa":a=1;break;case"dsa":a=2;break;case"ecdsa":a=3;break;default:throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`)}e.appendChar(a);const o=this.signature.toBER(!1);return e.appendUint16(o.byteLength),e.appendView(new Uint8Array(o)),e}toJSON(){return{version:this.version,logID:(0,i.RH)(this.logID),timestamp:this.timestamp,extensions:(0,i.RH)(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}async verify(e,t,r=0){let s,a=(0,i.s3)((0,i.lE)(this.logID)),o=null,l=new X;for(const t of e)if(t.log_id===a){o=t.key;break}if(null===o)throw new Error(`Public key not found for CT with logId: ${a}`);const c=n.sc((0,i.gG)((0,i.Gh)(o)));if(-1===c.offset)throw new Error(`Incorrect key value for CT Log with logId: ${a}`);s=new u({schema:c.result}),l.appendChar(0),l.appendChar(0);const h=new ArrayBuffer(8),f=new Uint8Array(h),m=(0,i.lL)(this.timestamp.valueOf(),8);return f.set(new Uint8Array(m),8-m.byteLength),l.appendView(f),l.appendUint16(r),0===r&&l.appendUint24(t.byteLength),l.appendView(new Uint8Array(t)),l.appendUint16(this.extensions.byteLength),0!==this.extensions.byteLength&&l.appendView(new Uint8Array(this.extensions)),A().subtle.verifyWithPublicKey(l._stream._buffer.slice(0,l._length),{valueBlock:{valueHex:this.signature.toBER(!1)}},s,{algorithmId:""},"SHA-256")}}class te{constructor(e={}){this.timestamps=(0,i.H$)(e,"timestamps",te.defaultValues("timestamps")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("timestamps"===e)return[];throw new Error(`Invalid member name for SignedCertificateTimestampList class: ${e}`)}static compareWithDefault(e,t){if("timestamps"===e)return 0===t.length;throw new Error(`Invalid member name for SignedCertificateTimestampList class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return"optional"in t==!1&&(t.optional=!1),new n.fi({name:t.blockName||"SignedCertificateTimestampList",optional:t.optional})}fromSchema(e){if(e instanceof n.fi==!1)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new X({stream:new Y({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new ee({stream:t}))}toSchema(){const e=new X;let t=0;const r=[];for(const e of this.timestamps){const n=e.toStream();r.push(n),t+=n.stream.buffer.byteLength}e.appendUint16(t);for(const t of r)e.appendView(t.stream.view);return new n.fi({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,(e=>e.toJSON()))}}}class re{constructor(e={}){this.templateID=(0,i.H$)(e,"templateID",re.defaultValues("templateID")),"templateMajorVersion"in e&&(this.templateMajorVersion=(0,i.H$)(e,"templateMajorVersion",re.defaultValues("templateMajorVersion"))),"templateMinorVersion"in e&&(this.templateMinorVersion=(0,i.H$)(e,"templateMinorVersion",re.defaultValues("templateMinorVersion"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"templateID":return"";case"templateMajorVersion":case"templateMinorVersion":return 0;default:throw new Error(`Invalid member name for CertificateTemplate class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.templateID||""}),new n.z8({name:t.templateMajorVersion||"",optional:!0}),new n.z8({name:t.templateMinorVersion||"",optional:!0})]})}fromSchema(e){(0,i.ze)(e,["templateID","templateMajorVersion","templateMinorVersion"]);let t=n.eN(e,e,re.schema({names:{templateID:"templateID",templateMajorVersion:"templateMajorVersion",templateMinorVersion:"templateMinorVersion"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificateTemplate");this.templateID=t.result.templateID.valueBlock.toString(),"templateMajorVersion"in t.result&&(this.templateMajorVersion=t.result.templateMajorVersion.valueBlock.valueDec),"templateMinorVersion"in t.result&&(this.templateMinorVersion=t.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const e=[];return e.push(new n.rP({value:this.templateID})),"templateMajorVersion"in this&&e.push(new n.z8({value:this.templateMajorVersion})),"templateMinorVersion"in this&&e.push(new n.z8({value:this.templateMinorVersion})),new n.T9({value:e})}toJSON(){const e={extnID:this.templateID};return"templateMajorVersion"in this&&(e.templateMajorVersion=this.templateMajorVersion),"templateMinorVersion"in this&&(e.templateMinorVersion=this.templateMinorVersion),e}}class ne{constructor(e={}){this.certificateIndex=(0,i.H$)(e,"certificateIndex",ne.defaultValues("certificateIndex")),this.keyIndex=(0,i.H$)(e,"keyIndex",ne.defaultValues("keyIndex")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"certificateIndex":case"keyIndex":return 0;default:throw new Error(`Invalid member name for CAVersion class: ${e}`)}}static schema(e={}){return new n.z8}fromSchema(e){if(e.constructor.blockName()!==n.z8.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const r=new Uint8Array(t);switch(!0){case t.byteLength<4:{const e=new ArrayBuffer(4);new Uint8Array(e).set(r,4-t.byteLength),t=e.slice(0)}break;case t.byteLength>4:{const e=new ArrayBuffer(4);new Uint8Array(e).set(r.slice(0,4)),t=e.slice(0)}}const i=t.slice(0,2),s=new Uint8Array(i);let a=s[0];s[0]=s[1],s[1]=a;const o=new Uint16Array(i);this.keyIndex=o[0];const l=t.slice(2),u=new Uint8Array(l);a=u[0],u[0]=u[1],u[1]=a;const c=new Uint16Array(l);this.certificateIndex=c[0]}toSchema(){const e=new ArrayBuffer(2);new Uint16Array(e)[0]=this.certificateIndex;const t=new Uint8Array(e);let r=t[0];t[0]=t[1],t[1]=r;const s=new ArrayBuffer(2);new Uint16Array(s)[0]=this.keyIndex;const a=new Uint8Array(s);return r=a[0],a[0]=a[1],a[1]=r,new n.z8({valueHex:(0,i.hk)(s,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}class ie{constructor(e={}){this.id=(0,i.H$)(e,"id",ie.defaultValues("id")),"type"in e&&(this.type=(0,i.H$)(e,"type",ie.defaultValues("type"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"id":return"";case"type":return new n.p2;default:throw new Error(`Invalid member name for QCStatement class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"id":return""===t;case"type":return t instanceof n.p2;default:throw new Error(`Invalid member name for QCStatement class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.id||""}),new n.IK({name:t.type||"",optional:!0})]})}fromSchema(e){(0,i.ze)(e,["id","type"]);const t=n.eN(e,e,ie.schema({names:{id:"id",type:"type"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for QCStatement");this.id=t.result.id.valueBlock.toString(),"type"in t.result&&(this.type=t.result.type)}toSchema(){const e=[new n.rP({value:this.id})];return"type"in this&&e.push(this.type),new n.T9({value:e})}toJSON(){const e={id:this.id};return"type"in this&&(e.type=this.type.toJSON()),e}}class se{constructor(e={}){this.values=(0,i.H$)(e,"values",se.defaultValues("values")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("values"===e)return[];throw new Error(`Invalid member name for QCStatements class: ${e}`)}static compareWithDefault(e,t){if("values"===e)return 0===t.length;throw new Error(`Invalid member name for QCStatements class: ${e}`)}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.ZD({name:t.values||"",value:ie.schema(t.value||{})})]})}fromSchema(e){(0,i.ze)(e,["values"]);const t=n.eN(e,e,se.schema({names:{values:"values"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for QCStatements");this.values=Array.from(t.result.values,(e=>new ie({schema:e})))}toSchema(){return new n.T9({value:Array.from(this.values,(e=>e.toSchema()))})}toJSON(){return{extensions:Array.from(this.values,(e=>e.toJSON()))}}}class ae{constructor(e={}){this.extnID=(0,i.H$)(e,"extnID",ae.defaultValues("extnID")),this.critical=(0,i.H$)(e,"critical",ae.defaultValues("critical")),this.extnValue="extnValue"in e?new n.fi({valueHex:e.extnValue}):ae.defaultValues("extnValue"),"parsedValue"in e&&(this.parsedValue=(0,i.H$)(e,"parsedValue",ae.defaultValues("parsedValue"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"extnID":return"";case"critical":return!1;case"extnValue":return new n.fi;case"parsedValue":return{};default:throw new Error(`Invalid member name for Extension class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[new n.rP({name:t.extnID||""}),new n.ge({name:t.critical||"",optional:!0}),new n.fi({name:t.extnValue||""})]})}fromSchema(e){(0,i.ze)(e,["extnID","critical","extnValue"]);let t=n.eN(e,e,ae.schema({names:{extnID:"extnID",critical:"critical",extnValue:"extnValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Extension");if(this.extnID=t.result.extnID.valueBlock.toString(),"critical"in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue,t=n.sc(this.extnValue.valueBlock.valueHex),-1!==t.offset)switch(this.extnID){case"2.5.29.9":try{this.parsedValue=new x({schema:t.result})}catch(e){this.parsedValue=new x,this.parsedValue.parsingError="Incorrectly formated SubjectDirectoryAttributes"}break;case"2.5.29.14":case"2.5.29.15":case"2.5.29.20":case"2.5.29.27":case"2.5.29.21":case"2.5.29.24":case"2.5.29.54":case"1.3.6.1.4.1.311.20.2":case"1.3.6.1.4.1.311.21.2":this.parsedValue=t.result;break;case"2.5.29.16":try{this.parsedValue=new I({schema:t.result})}catch(e){this.parsedValue=new I,this.parsedValue.parsingError="Incorrectly formated PrivateKeyUsagePeriod"}break;case"2.5.29.17":case"2.5.29.18":try{this.parsedValue=new U({schema:t.result})}catch(e){this.parsedValue=new U,this.parsedValue.parsingError="Incorrectly formated AltName"}break;case"2.5.29.19":try{this.parsedValue=new O({schema:t.result})}catch(e){this.parsedValue=new O,this.parsedValue.parsingError="Incorrectly formated BasicConstraints"}break;case"2.5.29.28":try{this.parsedValue=new D({schema:t.result})}catch(e){this.parsedValue=new D,this.parsedValue.parsingError="Incorrectly formated IssuingDistributionPoint"}break;case"2.5.29.29":try{this.parsedValue=new T({schema:t.result})}catch(e){this.parsedValue=new T,this.parsedValue.parsingError="Incorrectly formated GeneralNames"}break;case"2.5.29.30":try{this.parsedValue=new R({schema:t.result})}catch(e){this.parsedValue=new R,this.parsedValue.parsingError="Incorrectly formated NameConstraints"}break;case"2.5.29.31":case"2.5.29.46":try{this.parsedValue=new _({schema:t.result})}catch(e){this.parsedValue=new _,this.parsedValue.parsingError="Incorrectly formated CRLDistributionPoints"}break;case"2.5.29.32":case"1.3.6.1.4.1.311.21.10":try{this.parsedValue=new M({schema:t.result})}catch(e){this.parsedValue=new M,this.parsedValue.parsingError="Incorrectly formated CertificatePolicies"}break;case"2.5.29.33":try{this.parsedValue=new z({schema:t.result})}catch(e){this.parsedValue=new z,this.parsedValue.parsingError="Incorrectly formated CertificatePolicies"}break;case"2.5.29.35":try{this.parsedValue=new G({schema:t.result})}catch(e){this.parsedValue=new G,this.parsedValue.parsingError="Incorrectly formated AuthorityKeyIdentifier"}break;case"2.5.29.36":try{this.parsedValue=new q({schema:t.result})}catch(e){this.parsedValue=new q,this.parsedValue.parsingError="Incorrectly formated PolicyConstraints"}break;case"2.5.29.37":try{this.parsedValue=new W({schema:t.result})}catch(e){this.parsedValue=new W,this.parsedValue.parsingError="Incorrectly formated ExtKeyUsage"}break;case"1.3.6.1.5.5.7.1.1":case"1.3.6.1.5.5.7.1.11":try{this.parsedValue=new Q({schema:t.result})}catch(e){this.parsedValue=new Q,this.parsedValue.parsingError="Incorrectly formated InfoAccess"}break;case"1.3.6.1.4.1.11129.2.4.2":try{this.parsedValue=new te({schema:t.result})}catch(e){this.parsedValue=new te,this.parsedValue.parsingError="Incorrectly formated SignedCertificateTimestampList"}break;case"1.3.6.1.4.1.311.21.7":try{this.parsedValue=new re({schema:t.result})}catch(e){this.parsedValue=new re,this.parsedValue.parsingError="Incorrectly formated CertificateTemplate"}break;case"1.3.6.1.4.1.311.21.1":try{this.parsedValue=new ne({schema:t.result})}catch(e){this.parsedValue=new ne,this.parsedValue.parsingError="Incorrectly formated CAVersion"}break;case"1.3.6.1.5.5.7.1.3":try{this.parsedValue=new se({schema:t.result})}catch(e){this.parsedValue=new se,this.parsedValue.parsingError="Incorrectly formated QCStatements"}}}toSchema(){const e=[];return e.push(new n.rP({value:this.extnID})),this.critical!==ae.defaultValues("critical")&&e.push(new n.ge({value:this.critical})),e.push(this.extnValue),new n.T9({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==ae.defaultValues("critical")&&(e.critical=this.critical),"parsedValue"in this&&"toJSON"in this.parsedValue&&(e.parsedValue=this.parsedValue.toJSON()),e}}class oe{constructor(e={}){this.extensions=(0,i.H$)(e,"extensions",oe.defaultValues("extensions")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){if("extensions"===e)return[];throw new Error(`Invalid member name for Extensions class: ${e}`)}static schema(e={},t=!1){const r=(0,i.H$)(e,"names",{});return new n.T9({optional:t,name:r.blockName||"",value:[new n.ZD({name:r.extensions||"",value:ae.schema(r.extension||{})})]})}fromSchema(e){(0,i.ze)(e,["extensions"]);const t=n.eN(e,e,oe.schema({names:{extensions:"extensions"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Extensions");this.extensions=Array.from(t.result.extensions,(e=>new ae({schema:e})))}toSchema(){return new n.T9({value:Array.from(this.extensions,(e=>e.toSchema()))})}toJSON(){return{extensions:Array.from(this.extensions,(e=>e.toJSON()))}}}function le(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"tbsCertificate",value:[new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.z8({name:t.tbsCertificateVersion||"tbsCertificate.version"})]}),new n.z8({name:t.tbsCertificateSerialNumber||"tbsCertificate.serialNumber"}),s.schema(t.signature||{names:{blockName:"tbsCertificate.signature"}}),E.schema(t.issuer||{names:{blockName:"tbsCertificate.issuer"}}),new n.T9({name:t.tbsCertificateValidity||"tbsCertificate.validity",value:[N.schema(t.notBefore||{names:{utcTimeName:"tbsCertificate.notBefore",generalTimeName:"tbsCertificate.notBefore"}}),N.schema(t.notAfter||{names:{utcTimeName:"tbsCertificate.notAfter",generalTimeName:"tbsCertificate.notAfter"}})]}),E.schema(t.subject||{names:{blockName:"tbsCertificate.subject"}}),u.schema(t.subjectPublicKeyInfo||{names:{blockName:"tbsCertificate.subjectPublicKeyInfo"}}),new n.WV({name:t.tbsCertificateIssuerUniqueID||"tbsCertificate.issuerUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new n.WV({name:t.tbsCertificateSubjectUniqueID||"tbsCertificate.subjectUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[oe.schema(t.extensions||{names:{blockName:"tbsCertificate.extensions"}})]})]})}class ue{constructor(e={}){this.tbs=(0,i.H$)(e,"tbs",ue.defaultValues("tbs")),this.version=(0,i.H$)(e,"version",ue.defaultValues("version")),this.serialNumber=(0,i.H$)(e,"serialNumber",ue.defaultValues("serialNumber")),this.signature=(0,i.H$)(e,"signature",ue.defaultValues("signature")),this.issuer=(0,i.H$)(e,"issuer",ue.defaultValues("issuer")),this.notBefore=(0,i.H$)(e,"notBefore",ue.defaultValues("notBefore")),this.notAfter=(0,i.H$)(e,"notAfter",ue.defaultValues("notAfter")),this.subject=(0,i.H$)(e,"subject",ue.defaultValues("subject")),this.subjectPublicKeyInfo=(0,i.H$)(e,"subjectPublicKeyInfo",ue.defaultValues("subjectPublicKeyInfo")),"issuerUniqueID"in e&&(this.issuerUniqueID=(0,i.H$)(e,"issuerUniqueID",ue.defaultValues("issuerUniqueID"))),"subjectUniqueID"in e&&(this.subjectUniqueID=(0,i.H$)(e,"subjectUniqueID",ue.defaultValues("subjectUniqueID"))),"extensions"in e&&(this.extensions=(0,i.H$)(e,"extensions",ue.defaultValues("extensions"))),this.signatureAlgorithm=(0,i.H$)(e,"signatureAlgorithm",ue.defaultValues("signatureAlgorithm")),this.signatureValue=(0,i.H$)(e,"signatureValue",ue.defaultValues("signatureValue")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":case"issuerUniqueID":case"subjectUniqueID":return new ArrayBuffer(0);case"version":return 0;case"serialNumber":return new n.z8;case"signature":case"signatureAlgorithm":return new s;case"issuer":case"subject":return new E;case"notBefore":case"notAfter":return new N;case"subjectPublicKeyInfo":return new u;case"extensions":return[];case"signatureValue":return new n._K;default:throw new Error(`Invalid member name for Certificate class: ${e}`)}}static schema(e={}){const t=(0,i.H$)(e,"names",{});return new n.T9({name:t.blockName||"",value:[le(t.tbsCertificate),s.schema(t.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new n._K({name:t.signatureValue||"signatureValue"})]})}fromSchema(e){(0,i.ze)(e,["tbsCertificate","tbsCertificate.extensions","tbsCertificate.version","tbsCertificate.serialNumber","tbsCertificate.signature","tbsCertificate.issuer","tbsCertificate.notBefore","tbsCertificate.notAfter","tbsCertificate.subject","tbsCertificate.subjectPublicKeyInfo","tbsCertificate.issuerUniqueID","tbsCertificate.subjectUniqueID","signatureAlgorithm","signatureValue"]);const t=n.eN(e,e,ue.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:"tbsCertificate.extensions"}}}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Certificate");this.tbs=t.result.tbsCertificate.valueBeforeDecode,"tbsCertificate.version"in t.result&&(this.version=t.result["tbsCertificate.version"].valueBlock.valueDec),this.serialNumber=t.result["tbsCertificate.serialNumber"],this.signature=new s({schema:t.result["tbsCertificate.signature"]}),this.issuer=new E({schema:t.result["tbsCertificate.issuer"]}),this.notBefore=new N({schema:t.result["tbsCertificate.notBefore"]}),this.notAfter=new N({schema:t.result["tbsCertificate.notAfter"]}),this.subject=new E({schema:t.result["tbsCertificate.subject"]}),this.subjectPublicKeyInfo=new u({schema:t.result["tbsCertificate.subjectPublicKeyInfo"]}),"tbsCertificate.issuerUniqueID"in t.result&&(this.issuerUniqueID=t.result["tbsCertificate.issuerUniqueID"].valueBlock.valueHex),"tbsCertificate.subjectUniqueID"in t.result&&(this.subjectUniqueID=t.result["tbsCertificate.subjectUniqueID"].valueBlock.valueHex),"tbsCertificate.extensions"in t.result&&(this.extensions=Array.from(t.result["tbsCertificate.extensions"],(e=>new ae({schema:e})))),this.signatureAlgorithm=new s({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return"version"in this&&this.version!==ue.defaultValues("version")&&e.push(new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new n.z8({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new n.T9({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),"issuerUniqueID"in this&&e.push(new n.WV({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),"subjectUniqueID"in this&&e.push(new n.WV({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),"extensions"in this&&e.push(new n.FC({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new n.T9({value:Array.from(this.extensions,(e=>e.toSchema()))})]})),new n.T9({value:e})}toSchema(e=!1){let t={};if(!1===e){if(0===this.tbs.length)return ue.schema().value[0];t=n.sc(this.tbs).result}else t=this.encodeTBS();return new n.T9({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:(0,i.RH)(this.tbs,0,this.tbs.byteLength),serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return"version"in this&&this.version!==ue.defaultValues("version")&&(e.version=this.version),"issuerUniqueID"in this&&(e.issuerUniqueID=(0,i.RH)(this.issuerUniqueID,0,this.issuerUniqueID.byteLength)),"subjectUniqueID"in this&&(e.subjectUniqueID=(0,i.RH)(this.subjectUniqueID,0,this.subjectUniqueID.byteLength)),"extensions"in this&&(e.extensions=Array.from(this.extensions,(e=>e.toJSON()))),e}getPublicKey(e=null){return A().subtle.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}getKeyHash(e="SHA-1"){const t=S();return void 0===t?Promise.reject("Unable to create WebCrypto object"):t.digest({name:e},new Uint8Array(this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))}sign(e,t="SHA-1"){if(void 0===e)return Promise.reject("Need to provide a private key for signing");let r,i=Promise.resolve();const s=A();return i=i.then((()=>s.subtle.getSignatureParameters(e,t))),i=i.then((e=>{r=e.parameters,this.signature=e.signatureAlgorithm,this.signatureAlgorithm=e.signatureAlgorithm})),i=i.then((()=>{this.tbs=this.encodeTBS().toBER(!1)})),i=i.then((()=>s.subtle.signWithPrivateKey(this.tbs,e,r))),i=i.then((e=>{this.signatureValue=new n._K({valueHex:e})})),i}verify(e=null){let t={};return null!==e?t=e.subjectPublicKeyInfo:this.issuer.isEqual(this.subject)&&(t=this.subjectPublicKeyInfo),t instanceof u==!1?Promise.reject("Please provide issuer certificate as a parameter"):A().subtle.verifyWithPublicKey(this.tbs,this.signatureValue,t,this.signatureAlgorithm)}}},656:(e,t)=>{"use strict";class r{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e).slice().buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const n=r.toUint8Array(e),i=r.toUint8Array(t);if(n.length!==i.byteLength)return!1;for(let e=0;e<n.length;e++)if(n[e]!==i[e])return!1;return!0}static concat(...e){if(Array.isArray(e[0])){const t=e[0];let r=0;for(const e of t)r+=e.byteLength;const n=new Uint8Array(r);let i=0;for(const e of t){const t=this.toUint8Array(e);n.set(t,i),i+=t.length}return e[1]?this.toView(n,e[1]):n.buffer}return this.concat(e)}}class n{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){const t=r.toUint8Array(e);let n="";for(let e=0;e<t.length;e++)n+=String.fromCharCode(t[e]);return decodeURIComponent(escape(n))}}class i{static toString(e,t=!1){const n=r.toArrayBuffer(e),i=new DataView(n);let s="";for(let e=0;e<n.byteLength;e+=2){const r=i.getUint16(e,t);s+=String.fromCharCode(r)}return s}static fromString(e,t=!1){const r=new ArrayBuffer(2*e.length),n=new DataView(r);for(let r=0;r<e.length;r++)n.setUint16(2*r,e.charCodeAt(r),t);return r}}class s{static isHex(e){return"string"==typeof e&&/^[a-z0-9]+$/i.test(e)}static isBase64(e){return"string"==typeof e&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}static isBase64Url(e){return"string"==typeof e&&/^[a-zA-Z0-9-_]+$/i.test(e)}static ToString(e,t="utf8"){const n=r.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(n);case"binary":return this.ToBinary(n);case"hex":return this.ToHex(n);case"base64":return this.ToBase64(n);case"base64url":return this.ToBase64Url(n);case"utf16le":return i.toString(n,!0);case"utf16":case"utf16be":return i.toString(n);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return i.fromString(e,!0);case"utf16":case"utf16be":return i.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=r.toUint8Array(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!s.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!s.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=s.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return n.fromString(e);case"utf16":case"utf16be":return i.fromString(e);case"utf16le":case"usc2":return i.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=s.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return n.toString(e);case"utf16":case"utf16be":return i.toString(e);case"utf16le":case"usc2":return i.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}static ToBinary(e){const t=r.toUint8Array(e);let n="";for(let e=0;e<t.length;e++)n+=String.fromCharCode(t[e]);return n}static ToHex(e){const t=r.toUint8Array(e),n=[],i=t.length;for(let e=0;e<i;e++){const r=t[e].toString(16).padStart(2,"0");n.push(r)}return n.join("")}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!s.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const n=t.slice(e,e+2);r[e/2]=parseInt(n,16)}return r.buffer}static ToUtf16String(e,t=!1){return i.toString(e,t)}static FromUtf16String(e,t=!1){return i.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}s.DEFAULT_UTF8_ENCODING="utf8",t.vJ=r,t.ep=s},422:(e,t,r)=>{"use strict";function n(e,t,r){var n;return e instanceof Object==!1?r:null!==(n=e[t])&&void 0!==n?n:r}function i(e,t=0,r=e.byteLength-t,n=!1){let i="";for(const s of new Uint8Array(e,t,r)){const e=s.toString(16).toUpperCase();1===e.length&&(i+="0"),i+=e,n&&(i+=" ")}return i.trim()}function s(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function a(e,t,r=-1){const n=r;let i=e,s=0,a=Math.pow(2,t);for(let r=1;r<8;r++){if(e<a){let e;if(n<0)e=new ArrayBuffer(r),s=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),s=n}const a=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);a[s-e-1]=Math.floor(i/r),i-=a[s-e-1]*r}return e}a*=Math.pow(2,t)}return new ArrayBuffer(0)}function o(...e){let t=0,r=0;for(const r of e)t+=r.byteLength;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(new Uint8Array(t),r),r+=t.byteLength;return n}function l(...e){let t=0,r=0;for(const r of e)t+=r.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(t,r),r+=t.length;return i}function u(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const n=s(r,8),i=new ArrayBuffer(this.valueHex.byteLength),a=new Uint8Array(i);for(let t=0;t<this.valueHex.byteLength;t++)a[t]=e[t];a[0]&=127;return s(a,8)-n}function c(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=a(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let i=a(t,8,n),s=new Uint8Array(i);if(128&s[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),s=new Uint8Array(i);for(let r=0;r<e.byteLength;r++)s[r+1]=t[r];s[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}function h(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}function f(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)}r.d(t,{Gc:()=>u,Gh:()=>p,H$:()=>n,Ir:()=>l,J$:()=>v,RH:()=>i,dN:()=>h,gG:()=>b,hk:()=>o,lE:()=>y,lL:()=>a,qE:()=>c,r9:()=>s,s3:()=>d,vX:()=>f,ze:()=>k});const m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function d(e,t=!1,r=!1,n=!1){let i=0,s=0,a=0,o="";const l=t?g:m;if(n){let t=0;for(let r=0;r<e.length;r++)if(0!==e.charCodeAt(r)){t=r;break}e=e.slice(t)}for(;i<e.length;){const t=e.charCodeAt(i++);i>=e.length&&(s=1);const n=e.charCodeAt(i++);i>=e.length&&(a=1);const u=e.charCodeAt(i++),c=t>>2,h=(3&t)<<4|n>>4;let f=(15&n)<<2|u>>6,m=63&u;1===s?f=m=64:1===a&&(m=64),o+=r?64===f?`${l.charAt(c)}${l.charAt(h)}`:64===m?`${l.charAt(c)}${l.charAt(h)}${l.charAt(f)}`:`${l.charAt(c)}${l.charAt(h)}${l.charAt(f)}${l.charAt(m)}`:`${l.charAt(c)}${l.charAt(h)}${l.charAt(f)}${l.charAt(m)}`}return o}function p(e,t=!1,r=!1){const n=t?g:m;function i(e){for(let t=0;t<64;t++)if(n.charAt(t)===e)return t;return 64}function s(e){return 64===e?0:e}let a=0,o="";for(;a<e.length;){const t=i(e.charAt(a++)),r=a>=e.length?0:i(e.charAt(a++)),n=a>=e.length?0:i(e.charAt(a++)),l=a>=e.length?0:i(e.charAt(a++)),u=s(t)<<2|s(r)>>4,c=(15&s(r))<<4|s(n)>>2,h=(3&s(n))<<6|s(l);o+=String.fromCharCode(u),64!==n&&(o+=String.fromCharCode(c)),64!==l&&(o+=String.fromCharCode(h))}if(r){let e=-1;for(let t=o.length-1;t>=0;t--)if(0!==o.charCodeAt(t)){e=t;break}o=-1!==e?o.slice(0,e+1):""}return o}function y(e){let t="";const r=new Uint8Array(e);for(const e of r)t+=String.fromCharCode(e);return t}function b(e){const t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return r}const w=Math.log(2);function v(e){const t=Math.log(e)/w,r=Math.floor(t),n=Math.round(t);return r===n?r:n}function k(e,t){for(const r of t)delete e[r]}},475:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<s(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,a=i>>>1;n<a;){var o=2*(n+1)-1,l=e[o],u=o+1,c=e[u];if(0>s(l,r))u<i&&0>s(c,l)?(e[n]=c,e[u]=r,n=u):(e[n]=l,e[o]=r,n=o);else{if(!(u<i&&0>s(c,r)))break e;e[n]=c,e[u]=r,n=u}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],h=1,f=null,m=3,g=!1,d=!1,p=!1,y="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,w="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var t=n(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,r(u,t)}t=n(c)}}function k(e){if(p=!1,v(e),!d)if(null!==n(u))d=!0,L(A);else{var t=n(c);null!==t&&U(k,t.startTime-e)}}function A(e,r){d=!1,p&&(p=!1,b(E),E=-1),g=!0;var s=m;try{for(v(r),f=n(u);null!==f&&(!(f.expirationTime>r)||e&&!I());){var a=f.callback;if("function"==typeof a){f.callback=null,m=f.priorityLevel;var o=a(f.expirationTime<=r);r=t.unstable_now(),"function"==typeof o?f.callback=o:f===n(u)&&i(u),v(r)}else i(u);f=n(u)}if(null!==f)var l=!0;else{var h=n(c);null!==h&&U(k,h.startTime-r),l=!1}return l}finally{f=null,m=s,g=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,B=!1,C=null,E=-1,N=5,x=-1;function I(){return!(t.unstable_now()-x<N)}function P(){if(null!==C){var e=t.unstable_now();x=e;var r=!0;try{r=C(!0,e)}finally{r?S():(B=!1,C=null)}}else B=!1}if("function"==typeof w)S=function(){w(P)};else if("undefined"!=typeof MessageChannel){var H=new MessageChannel,V=H.port2;H.port1.onmessage=P,S=function(){V.postMessage(null)}}else S=function(){y(P,0)};function L(e){C=e,B||(B=!0,S())}function U(e,r){E=y((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){d||g||(d=!0,L(A))},t.unstable_forceFrameRate=function(e){0>e||125<e||(N=0<e?Math.floor(1e3/e):5)},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var r=m;m=t;try{return e()}finally{m=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=m;m=e;try{return t()}finally{m=r}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"==typeof s&&null!==s?s="number"==typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,r(c,e),null===n(u)&&e===n(c)&&(p?(b(E),E=-1):p=!0,U(k,s-a))):(e.sortIndex=o,r(u,e),d||g||(d=!0,L(A))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=m;return function(){var r=m;m=t;try{return e.apply(this,arguments)}finally{m=r}}}},616:(e,t,r)=>{"use strict";e.exports=r(475)},753:(e,t,r)=>{"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{Z:()=>n})},795:(e,t,r)=>{"use strict";function n(e,t,r,n,i,s,a){try{var o=e[s](a),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,s){var a=e.apply(t,r);function o(e){n(a,i,s,o,l,"next",e)}function l(e){n(a,i,s,o,l,"throw",e)}o(void 0)}))}}r.d(t,{Z:()=>i})},249:(e,t,r)=>{"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,{Z:()=>n})},371:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}r.d(t,{Z:()=>i})},666:(e,t,r)=>{"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{Z:()=>n})},58:(e,t,r)=>{"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.d(t,{Z:()=>n})},754:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(960);function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,n.Z)(e,t)}},987:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(522),i=r(753);function s(e,t){if(t&&("object"===(0,n.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},960:(e,t,r)=>{"use strict";function n(e,t){return n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}r.d(t,{Z:()=>n})},790:(e,t,r)=>{"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,s=[],a=!0,o=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(s.push(n.value),!t||s.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(o)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(t,{Z:()=>i})},522:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:()=>n})},501:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(58),i=r(960);function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function a(e,t,r){return a=s()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var s=new(Function.bind.apply(e,n));return r&&(0,i.Z)(s,r.prototype),s},a.apply(null,arguments)}function o(e){var t="function"==typeof Map?new Map:void 0;return o=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return a(e,arguments,(0,n.Z)(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),(0,i.Z)(s,e)},o(e)}}}]);